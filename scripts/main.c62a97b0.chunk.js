(this["webpackJsonpip-feedback"]=this["webpackJsonpip-feedback"]||[]).push([[0],{104:function(e,t,a){e.exports=a.p+"static/media/FeedbackPen.dfc48fb9.png"},139:function(e,t,a){e.exports=a(167)},144:function(e,t,a){},149:function(e,t,a){},167:function(e,t,a){"use strict";a.r(t);var i=a(0),n=a.n(i),s=a(47),r=a.n(s),o=(a(144),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function c(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var l,p=a(8),d=a(12),u=a(44);!function(e){e.Information="Information",e.Error="Error",e.Exception="Exception"}(l||(l={}));var m=function(){function e(t,a){Object(p.a)(this,e),e.userAlias=t;var i={instrumentationKey:this.GetAIIKey()};void 0!==u.AppInsights.downloadAndSetup&&u.AppInsights.downloadAndSetup(i),u.AppInsights.setAuthenticatedUserContext(t),u.AppInsights.trackPageView(a,window.location.href,{Alias:t})}return Object(d.a)(e,[{key:"GetAIIKey",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;return e.toLowerCase().indexOf("https://cpsui-dev.")>-1||e.toLowerCase().indexOf("/localhost:")>-1?"8d188f25-4d90-421a-ab66-217f77e754ce":e.toLowerCase().indexOf("https://cpsui-stg.")>-1?"5db78f65-9ad5-4512-8ba4-a8e99a062b6b":e.toLowerCase().indexOf("https://cpsui-uat.")>-1?"b3535cfb-ac7d-401f-a17d-9ce9bbdbf839":"2616402f-6159-4ed0-9aea-dbed276a334e"}}],[{key:"AppInsightsTrackEvent",value:function(t,a,i,n,s){var r={EventType:a,EventSubType:i,Message:n,ControlID:s,Url:window.location.href,Alias:this.userAlias};if(!e.userAlias)throw new Error("Logging not initiated. Please initiate at base component");try{u.AppInsights.trackEvent(t,r)}catch(o){console.log("Error: "+o.message.toString())}}},{key:"AppInsightsTrackException",value:function(t,a,i,n){if(!e.userAlias)throw new Error("Logging not initiated. Please initiate at base component");try{var s={name:t};this.AppInsightsTrackEvent(t,l.Exception,"CustomError",i.message+" "+a,""),u.AppInsights.trackException(i,a,s)}catch(r){console.log("Error: "+r.message.toString())}}}]),e}();m.userAlias=void 0;var h,f=a(4),b=a.n(f),g=a(10),k=a(28),I=a(19),v=a(18),S=a(6),y=a.n(S),T=a(23),E={clientId:"e0f60ff0-327b-43e2-9055-54782bbed141",tenant:"microsoft.onmicrosoft.com",endpoints:{graphApiUri:"https://graph.microsoft.com",IDRApiUri:"https://idrservice-stg.azurewebsites.net",WebApiUri:"https://campuswebapi.azurewebsites.net",TeamsApiUri:"https://teamsforcampus.azurewebsites.net",DevOpsAPIUri:"499b84ac-1321-427f-aa17-267ca6975798"},postLogoutRedirectUri:window.location.origin,cacheLocation:"sessionStorage"},C=new T.AuthenticationContext(E);!function(e){e.Campus="https://campuswebapi",e.IDR="https://idrservice",e.MSGraph="https://graph.microsoft.com",e.Teams="https://teamsforcampus.azurewebsites.net",e.TeamsRoot="https://teamsforcampus"}(h||(h={}));var A,P,O,x,w,D,N=function(){function e(){Object(p.a)(this,e)}return Object(d.a)(e,[{key:"getResource",value:function(e){return(e=e.substr(0,30).toLowerCase()).indexOf("https://idrservice")>-1?E.endpoints.IDRApiUri:e.indexOf("https://graph.microsoft.com")>-1?E.endpoints.graphApiUri:e.indexOf("https://campuswebapi")>-1?E.endpoints.WebApiUri:e.indexOf("https://teamsforcampus")>-1?E.endpoints.TeamsApiUri:e.indexOf("https://dev.azure.com")>-1?E.endpoints.DevOpsAPIUri:E.endpoints.WebApiUri}},{key:"getAPIBaseURL",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.href;return t.toLowerCase().indexOf("https://cpsui-dev.")>-1||t.toLowerCase().indexOf("/localhost:")>-1||t.toLowerCase().indexOf("https://cpsui-stg.")>-1?e+"-stg.azurewebsites.net/api/":t.toLowerCase().indexOf("https://cpsui-uat.")>-1?e+"-uat.azurewebsites.net/api/":t.toLowerCase().indexOf("https://cpsui-extuat.")>-1?e+"-extuat.azurewebsites.net/api/":e+".azurewebsites.net/api/"}},{key:"getEnvironment",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;return e.toLowerCase().indexOf("https://cpsui-dev.")>-1||e.toLowerCase().indexOf("/localhost:")>-1?"DEV":e.toLowerCase().indexOf("https://cpsui-stg.")>-1?"STG":e.toLowerCase().indexOf("https://cpsui-uat.")>-1?"UAT":e.toLowerCase().indexOf("https://cpsui-extuat.")>-1?"EXTUAT":"Prod"}},{key:"GetCampusWebAPI",value:function(e,t){var a=this;return new Promise((function(i,n){var s;try{s=e===h.MSGraph||e===h.Teams?e+"/"+t:a.getAPIBaseURL(e)+t,i(Object(T.adalFetch)(C,a.getResource(s),fetch,s,{method:"GET",headers:{Accept:"application/json;odata=verbose","Content-type":"application/json;odata=verbose"}}).then((function(e){return e.json()})))}catch(r){n(r)}}))}},{key:"GetCampusWebAPI1",value:function(e,t,a){var i=this;return new Promise((function(n,s){var r,o={headers:new Headers({Accept:"application/json; odata=verbose",Authorization:"Bearer ".concat(a)})};try{r=e===h.MSGraph||e===h.Teams?e+"/"+t:i.getAPIBaseURL(e)+t,fetch(r,o).then((function(e){console.log(e),n(e)})).catch((function(e){s(e),console.log(e)}))}catch(c){s(c)}}))}},{key:"GetCampusADOlists",value:function(e,t){var a=this;return new Promise((function(i,n){var s;try{s="https://dev.azure.com/"+e+t,console.log(s),i(Object(T.adalFetch)(C,a.getResource(s),fetch,s,{method:"GET",headers:{Accept:"application/json;odata=verbose","Content-type":"application/json;odata=verbose"}}).then((function(e){return e.json()})))}catch(r){n(r)}}))}},{key:"PostCampusADO",value:function(e,t,a,i,n){var s=this;return new Promise((function(n,r){var o,c={method:"POST",body:a,headers:i};try{o="https://dev.azure.com/"+e+"/"+t,console.log(o),n(Object(T.adalFetch)(C,s.getResource(o),fetch,o,c).then((function(e){return e.json()})))}catch(l){r(l)}}))}},{key:"PostCampusWebAPI",value:function(e,t,a,i){var n=this;return new Promise((function(i,s){var r,o={method:"POST",body:a,headers:{Accept:"application/json;odata=verbose","Content-type":"application/json;odata=verbose"}};try{r=e===h.MSGraph||e===h.Teams?e+"/"+t:n.getAPIBaseURL(e)+t,i(Object(T.adalFetch)(C,n.getResource(r),fetch,r,o).then((function(e){return e.json()})))}catch(c){s(c)}}))}}]),e}(),F=(Object(T.withAdalLogin)(C,E.endpoints.WebApiUri),function(){var e=C.getCachedUser();return null!==e||void 0!==e?C.getCachedUser().profile.name:""}),M=function(){var e=C.getCachedUser();return null!==e||void 0!==e?C.getCachedUser().userName.split("@")[0]:""},U=function(){var e=C.getCachedUser();return null!==e||void 0!==e?C.getCachedUser().userName:""},j=a(39),_=a(104),B=a.n(_),L=a(43),K=a(32),R=a(105),G=a.n(R),V=(a(77),a(238)),W=a(213),z=a(242),H=a(50),J=a(230),q=a(208),X=function(e){Object(I.a)(a,e);var t=Object(v.a)(a);function a(e){var i;return Object(p.a)(this,a),(i=t.call(this,e))._hostId=Object(q.a)("tooltipHost"),i}return Object(d.a)(a,[{key:"render",value:function(){return i.createElement(J.a,{content:this.props.content,id:this._hostId,calloutProps:{gapSpace:0},styles:{root:{display:"inline-block"}}},i.createElement("i",{className:"ms-Icon ms-Icon--Info",tabIndex:0,"aria-describedby":this._hostId}))}}]),a}(i.Component),$=(a(149),function e(){Object(p.a)(this,e)});$.ButtonName=(P=A=function e(){Object(p.a)(this,e)},A.existingIp="existingip",A.allFeedback="allfeedback",A.assignFeedback="assignfeedback",A.cancelFeedback="cancelfeedback",P),$.FeedBackType=(x=O=function e(){Object(p.a)(this,e)},O.domain="Domain",O.ipGap="Gap",O.ipfeedback="IP",x),$.PageType=(D=w=function e(){Object(p.a)(this,e)},w.ipforumOffer="ipforumoffer",w.ipforumIpkit="ipforumipkit",w.internalIpkit="internalipkit",D);var Z=function(){function e(){Object(p.a)(this,e),this.fileName="SessionStorage.ts",this.myStorage=window.sessionStorage}return Object(d.a)(e,[{key:"SetSessionStorage",value:function(e,t){try{sessionStorage.setItem(e,t)}catch(a){m.AppInsightsTrackException(ft,"Exception occured at SetSessionStorage(). "+this.fileName,a)}}},{key:"GetSessionStorage",value:function(e){try{return sessionStorage.getItem(e)}catch(t){m.AppInsightsTrackException(ft,"Exception occured at GetSessionStorage(). "+this.fileName,t)}}},{key:"DeleteSessionStorage",value:function(e){try{sessionStorage.removeItem(e)}catch(t){m.AppInsightsTrackException(ft,"Exception occured at DeleteSessionStorage(). "+this.fileName,t)}}}]),e}();Object(H.a)(),Object(W.a)();var Y="",Q=function(e){Object(I.a)(a,e);var t=Object(v.a)(a);function a(e){var i;return Object(p.a)(this,a),(i=t.call(this,e)).previousSearchStr="",i.webapi=new N,i.stroageObj=new Z,i.CUSTOMEVENTNAME="IPFeedBack",i.selectIPToolTip="Select any Offer or IPKit related to the engagement or any individual artifacts that you want to give feedback on.",i.selectIPKitToolTip="Select IPKit that you want to give feedback on.",i.selectOfferToolTip="Select Offer that you want to give feedback on.",i.offersToolTip="Microsoft Standard offer (MSO) Standard Offer (SO) related to the engagement based on CompassOne deal. Only Top 5 Offers will be shown and make use of Search box to select other Offers.",i.ipkitsToolTip="IPKits based on relationship with offers in CompassOne deal. Only Top 5 IPKits will be shown and make use of Search box to select other IPKits.",i.ipkitToolTip="IPKit and its related documents will be shown",i.offerToolTip="Offer and its related documents will be shown",i.noADOConfigToolTip="ADO Configuration not found for the IP. The feedback cannot be submitted, please contact respective Domain IP lead for getting the ADO configuration updated to be able to submit feedback.",i.getIPKitsOffersListItems="GetIPKitsOffersListItems",i.domainsDetailText="DomainsDetails",i.reportIpGapText="Report IP Gap",i.domainFeedbackText="Domain Feedback",i.ipkitText="IPKits",i.offerText="Offers",i.ipGapText="IP Gap",i.globalStateObj=[],i.noItemNode=[{value:"-3",label:"No Items",showCheckbox:!1}],i.loadingNode=[{value:"-3",label:"Loading...",showCheckbox:!1}],i.state={checked:[],expanded:["-1","-2"],mainParentGroup:""===i.props.sourceName.toLocaleLowerCase()?[{value:"-1",label:"Offers",showCheckbox:!1,icon:n.a.createElement(X,{content:i.offersToolTip}),children:i.loadingNode},{value:"-2",label:"IPKits",showCheckbox:!1,icon:n.a.createElement(X,{content:i.ipkitsToolTip}),children:i.loadingNode}]:"internalipkit"===i.props.sourceName.toLocaleLowerCase()||"ipforumipkit"===i.props.sourceName.toLocaleLowerCase()?[{value:"-2",label:"IPKits",showCheckbox:!1,icon:n.a.createElement(X,{content:i.ipkitToolTip}),children:i.loadingNode}]:[{value:"-1",label:"Offers",showCheckbox:!1,icon:n.a.createElement(X,{content:i.offerToolTip}),children:i.loadingNode}],filterText:""},i.ipItems=[],i.offerItems=[],i.ipkitItems=[],i.childItems=[],i.onCheck=i.onCheck.bind(Object(k.a)(i)),i.onExpand=i.onExpand.bind(Object(k.a)(i)),i.globalStateObj=Object(K.a)(i.state.mainParentGroup),i}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.GetListItems()}},{key:"componentWillReceiveProps",value:function(e){try{if(e.reset&&(Y="",this.setState({checked:[]})),e.searchStr&&e.searchStr!==this.previousSearchStr||e.clearResetFlag){this.previousSearchStr=e.searchStr;var t=e.searchStr;this._onFilter(t)}}catch(a){m.AppInsightsTrackException(ft,"Exception occured at componentWillReceiveProps() ",a)}}},{key:"onCheck",value:function(e){var t;this.props.sourceName.toUpperCase()===$.PageType.internalIpkit.toUpperCase()||this.props.sourceName.toUpperCase()===$.PageType.ipforumIpkit.toUpperCase()?(t=1,this.CheckIPKit(e,t)):this.props.sourceName.toUpperCase()===$.PageType.ipforumOffer.toUpperCase()?(t=0,this.CheckIPKit(e,t)):this.CheckIPKitOffers(e)}},{key:"onExpand",value:function(e){this.setState({expanded:e})}},{key:"_onFilter",value:function(e){var t,a,i,s,r=e.toLocaleLowerCase(),o=[];if(this.props.sourceName.toUpperCase()===$.PageType.internalIpkit.toUpperCase()||this.props.sourceName.toUpperCase()===$.PageType.ipforumIpkit.toUpperCase())s=(t=this.ipkitItems.filter((function(e){return-1!==e.label.toLocaleLowerCase().indexOf(r)}))).length>0?t.slice(0,5):this.noItemNode,o=[{value:"-2",label:"IPKits",showCheckbox:!1,icon:n.a.createElement(X,{content:this.ipkitToolTip}),children:s}];else if(this.props.sourceName.toUpperCase()===$.PageType.ipforumOffer.toUpperCase())i=(a=this.offerItems.filter((function(e){return-1!==e.label.toLocaleLowerCase().indexOf(r)}))).length>0?a.slice(0,5):this.noItemNode,o=[{value:"-1",label:"Offers",showCheckbox:!1,icon:n.a.createElement(X,{content:this.offerToolTip}),children:i}];else{a=this.offerItems.filter((function(e){return-1!==e.label.toLocaleLowerCase().indexOf(r)})),t=this.ipkitItems.filter((function(e){return-1!==e.label.toLocaleLowerCase().indexOf(r)})),i=a.length>0?a.slice(0,5):this.noItemNode,s=t.length>0?t.slice(0,5):this.noItemNode;var c=Object(K.a)(this.state.mainParentGroup);o=[{value:"-1",label:"Offers",showCheckbox:!1,icon:n.a.createElement(X,{content:this.offersToolTip}),children:i},{value:"-2",label:"IPKits",showCheckbox:!1,icon:n.a.createElement(X,{content:this.ipkitsToolTip}),children:s},Object(L.a)({},c[2]),Object(L.a)({},c[3])]}this.setState({mainParentGroup:o})}},{key:"render",value:function(){var e=this.state,t=e.checked,a=e.expanded,i=e.mainParentGroup;return n.a.createElement("div",{className:"filter-container"},n.a.createElement("div",{className:y.a.selectItemText},"Select an item to give feedback:"),n.a.createElement(G.a,{checked:t,expanded:a,nodes:i,onCheck:this.onCheck,onExpand:this.onExpand,nativeCheckboxes:!0,noCascade:!0,icons:{check:n.a.createElement(V.a,{tabIndex:0,onKeyPress:this._onEnterCheckbox.bind(this),iconName:"SkypeCircleCheck"}),uncheck:n.a.createElement(V.a,{tabIndex:0,onKeyPress:this._onEnterCheckbox.bind(this),iconName:"RadioBtnOff","aria-hidden":"False"}),expandClose:n.a.createElement("i",{className:"ms-Icon ms-Icon--ChevronRight"}),expandOpen:n.a.createElement("i",{className:"ms-Icon ms-Icon--ChevronDown"}),expandAll:n.a.createElement("i",{className:"ms-Icon ms-Icon--ChevronDownMed"}),collapseAll:n.a.createElement("i",{className:"ms-Icon ms-Icon--ChevronRightMed"}),parentClose:n.a.createElement("span",{className:"parentClose"}),parentOpen:n.a.createElement("span",{className:"parentOpen"})}}))}},{key:"CheckIPKitOffers",value:function(e){if(e.length>0?(""!==Y&&void 0!==Y&&e.splice(e.indexOf(Y),1),Y=e[0]):Y="",bt.indexOf(Y.trim())>=0||Y.trim().toUpperCase().indexOf($.FeedBackType.ipGap.toUpperCase())>=0)this.props.ipTitle({IPTitle:Y.trim(),IPType:3,IPSource:Y.trim().toUpperCase().indexOf($.FeedBackType.ipGap.toUpperCase())?$.FeedBackType.ipGap:$.FeedBackType.domain,IPID:Y.trim().toUpperCase().indexOf($.FeedBackType.ipGap.toUpperCase())?1:4});else{var t=""!==Y&&void 0!==Y?this.ipItems.filter((function(e){return e.KnowledgeMapItemID.toString()===Y}))[0]:"";""!==t?this.props.ipTitle({IPTitle:t.ParentTitle,IPType:t.Category,IPSource:t.Source,IPID:0==t.Category?t.OID:t.IPKitID}):this.props.ipTitle(t)}this.setState({checked:e}),""!=Y&&m.AppInsightsTrackEvent(this.CUSTOMEVENTNAME,"Information","Custom IP Filter","IP Filters Checkbox Selected",Y)}},{key:"CheckIPKit",value:function(e,t){var a=[],i=this.ipItems.ParentTitle;if(e.length>0?(""!==Y&&void 0!==Y&&e.splice(e.indexOf(Y),1),Y=e[0]):Y="",""!==Y&&void 0!==Y){var n=[];if(this.ipItems.ParentTitle===Y)a=this.ipItems,this.props.ipTitle({IPTitle:a.ParentTitle,IPType:t,IPSource:this.props.siteUrl,IPID:a.IPKitOrOfferID});else{this.ipItems.IPKitOfferRecords.map((function(e){var t={Title:e.Title,Source:e.Source};n.push(t)}));for(var s=0;s<n.length;s++)if(n[s].Title===Y){a=n[s],this.props.ipTitle({IPTitle:i,IPType:t,IPSource:a.Source,IPID:this.ipItems.IPKitOrOfferID});break}}}""===a&&void 0===a&&this.props.ipTitle(a),this.setState({checked:e}),""!=Y&&m.AppInsightsTrackEvent(this.CUSTOMEVENTNAME,"Information","Custom IP Filter","IP Filters Checkbox Selected",Y)}},{key:"GetListItems",value:function(){try{if(this.props.sourceName.toUpperCase()===$.PageType.internalIpkit.toUpperCase()||this.props.sourceName.toUpperCase()===$.PageType.ipforumIpkit.toUpperCase())this.GetIPKitListItems();else if(this.props.sourceName.toUpperCase()===$.PageType.ipforumOffer.toUpperCase())this.GetOfferListItems();else{var e=this.stroageObj.GetSessionStorage(this.getIPKitsOffersListItems+this.props.siteName),t=this.stroageObj.GetSessionStorage(this.domainsDetailText+this.props.siteName);null!==e?this.GetIPKitsOffersListItems(JSON.parse(e)):this.GetIPKitsOffersListItemsApiCall(),null!==t?this.SetDomains(JSON.parse(t)):this.GetDomainsApiCall()}}catch(a){m.AppInsightsTrackException(ft,"Exception occured at GetListItems() ",a)}}},{key:"GetIPKitsOffersListItemsApiCall",value:function(){var e=this;try{var t="IPFeedback/GetKMapIPKitandOffersItems?projSite="+this.props.siteUrl;this.webapi.GetCampusWebAPI(h.Campus,t).then((function(t){e.GetIPKitsOffersListItems(t),e.stroageObj.SetSessionStorage(e.getIPKitsOffersListItems+e.props.siteName,JSON.stringify(t))})).catch((function(e){m.AppInsightsTrackException(ft,"Exception occured at Api Call GetIPKitsOffersListItemsApiCall() ",e)}))}catch(a){m.AppInsightsTrackException(ft,"Exception occured at GetIPKitsOffersListItemsApiCall() ",a)}}},{key:"GetDomainsApiCall",value:function(){var e=this;try{var t="IPFeedback/GetKMapIPKitandOffersItemsWithDomain?projSite="+this.props.siteUrl;this.webapi.GetCampusWebAPI(h.Campus,t).then((function(t){e.SetDomains(t),e.stroageObj.SetSessionStorage(e.domainsDetailText+e.props.siteName,JSON.stringify(t))})).catch((function(e){m.AppInsightsTrackException(ft,"Exception occured at Api Call GetDomainsApiCall() ",e)}))}catch(a){m.AppInsightsTrackException(ft,"Exception occured at GetDomainsApiCall() ",a)}}},{key:"SetDomains",value:function(e){var t=this;try{var a=Object(K.a)(this.globalStateObj),i=[];if(e.map((function(e){var t={value:e.Value,label:e.Label,disabled:e.Disabled,title:e.Title};i.push(t)})),0===Object.values(a).filter((function(e){return e.label===t.ipGapText})).length){var n={value:"-5",label:"IP Gap",showCheckbox:!1,children:[{value:this.reportIpGapText,label:this.reportIpGapText,disabled:!1,title:this.reportIpGapText}]};a.push(n)}if(void 0===a.filter((function(e){return e.label===t.domainFeedbackText}))[0]){var s={value:"-6",label:this.domainFeedbackText,showCheckbox:!1,children:i};a.push(s)}else 1===a.filter((function(e){return e.label===t.domainFeedbackText}))[0].children.length&&(a.filter((function(e){return e.label===t.domainFeedbackText}))[0].children=[].concat(i));this.globalStateObj=Object(K.a)(a),this.setState({mainParentGroup:[]}),this.setState({mainParentGroup:Object(K.a)(a),expanded:["-1","-2","-5","-6"]})}catch(r){m.AppInsightsTrackException(ft,"Exception occured at SetDomains() ",r)}}},{key:"GetIPKitsOffersListItems",value:function(e){var t=this;try{if(null===e||void 0===e||0===e.length){var a=[{value:"-1",label:"Offers",showCheckbox:!1,icon:n.a.createElement(X,{content:this.offersToolTip}),children:this.noItemNode},{value:"-2",label:"IPKits",showCheckbox:!1,icon:n.a.createElement(X,{content:this.ipkitsToolTip}),children:this.noItemNode}];return void this.setState({mainParentGroup:a,expanded:["-1","-2"]})}if(void 0!=e.Message)return;this.ipItems=e,this.childItems=e.filter((function(e){return 1!==e.ParentID})).sort((function(e){return e.ParentID}));var i=e.filter((function(e){return 1===e.ParentID&&1===e.Category})).sort((function(e){return e.KnowledgeMapItemID})),s=e.filter((function(e){return 1===e.ParentID&&0===e.Category})).sort((function(e){return e.KnowledgeMapItemID}));i.length>0&&i.map((function(e){if(null!==e.Title&&""!==e.Title&&void 0!==e.Title){var a=[];if(t.childItems.filter((function(t){return t.ParentID===e.KnowledgeMapItemID})).map((function(i){var s=i.Source.slice(2+(i.Source.lastIndexOf(".")-1>>>0)),r={value:i.KnowledgeMapItemID,label:i.Title,disabled:null===e.ADOID||void 0===e.ADOID,title:null===i.ADOID||void 0===i.ADOID?t.noADOConfigToolTip:i.Title,icon:n.a.createElement(V.a,Object(z.a)({extension:s,size:16,imageFileType:"png"}))};a.push(r)})),a.length>0){var i={value:e.KnowledgeMapItemID,label:e.Title,disabled:null===e.ADOID||void 0===e.ADOID,title:null===e.ADOID||void 0===e.ADOID?t.noADOConfigToolTip:e.Title,children:a};t.ipkitItems.push(i)}else{var s={value:e.KnowledgeMapItemID,label:e.Title,disabled:null===e.ADOID||void 0===e.ADOID,title:null===e.ADOID||void 0===e.ADOID?t.noADOConfigToolTip:e.Title};t.ipkitItems.push(s)}}})),s.length>0&&s.map((function(e){if(null!==e.Title&&""!==e.Title&&void 0!==e.Title){var a=[];if(t.childItems.filter((function(t){return t.ParentID===e.KnowledgeMapItemID})).map((function(i){var s=i.Source.slice(2+(i.Source.lastIndexOf(".")-1>>>0)),r={value:i.KnowledgeMapItemID,label:i.Title,disabled:null===e.ADOID||void 0===e.ADOID,title:null===i.ADOID||void 0===i.ADOID?t.noADOConfigToolTip:i.Title,icon:n.a.createElement(V.a,Object(z.a)({extension:s,size:16,imageFileType:"png"}))};a.push(r)})),a.length>0){var i={value:e.KnowledgeMapItemID,label:e.Title,disabled:null===e.ADOID||void 0===e.ADOID,title:null===e.ADOID||void 0===e.ADOID?t.noADOConfigToolTip:e.Title,children:a};t.offerItems.push(i)}else{var s={value:e.KnowledgeMapItemID,label:e.Title,disabled:null===e.ADOID||void 0===e.ADOID,title:null===e.ADOID||void 0===e.ADOID?t.noADOConfigToolTip:e.Title};t.offerItems.push(s)}}}));var r=this.offerItems.length>0?this.offerItems.slice(0,5):this.noItemNode,o=this.ipkitItems.length>0?this.ipkitItems.slice(0,5):this.noItemNode,c=[{value:this.reportIpGapText,label:this.reportIpGapText,disabled:!1,title:this.reportIpGapText}],l=Object(K.a)(this.globalStateObj);if(void 0!==Object.values(l).filter((function(e){return e.label===t.offerText}))&&(Object.values(l).filter((function(e){return e.label===t.offerText}))[0].children=r),void 0!==Object.values(l).filter((function(e){return e.label===t.ipkitText}))[0])Object.values(l).filter((function(e){return e.label===t.ipkitText}))[0].children=o;else{var p={value:"-2",label:"IPKits",showCheckbox:!1,icon:n.a.createElement(X,{content:this.ipkitsToolTip}),children:o};l.push(p)}if(void 0===Object.values(l).filter((function(e){return e.label===t.ipGapText}))[0]){var d={value:"-5",label:"IP Gap",showCheckbox:!1,children:c};l.push(d)}if(void 0===Object.values(l).filter((function(e){return e.label===t.domainFeedbackText}))[0]){var u={value:"-6",label:this.domainFeedbackText,showCheckbox:!1,children:this.loadingNode};l.push(u)}this.globalStateObj=Object(K.a)(l),this.setState({mainParentGroup:[]}),this.setState({mainParentGroup:Object(K.a)(l),expanded:["-1","-2","-5","-6"]})}catch(h){m.AppInsightsTrackException(ft,"Exception occured at GetIPKitsOffersListItems() ",h)}}},{key:"_onEnterCheckbox",value:function(e){null===e||13!==e.keyCode&&13!==e.which||e.target.click()}},{key:"GetIPKitListItems",value:function(){var e=this,t="IPFeedback/GetIPKitandOffersItems?ipKitOfferSite="+this.props.siteUrl+"&sourceName="+this.props.sourceName;this.webapi.GetCampusWebAPI(h.Campus,t).then((function(t){if(console.log(t),null!==t&&void 0!==t&&0!==t.length){if(void 0==t.Message){e.ipItems=t;var a=t,i=t.IPKitOfferRecords,s=[],r=null===a.AdoId||void 0===a.AdoId;i.map((function(t){var a=t.Source.slice(2+(t.Source.lastIndexOf(".")-1>>>0)),i={value:t.Title,label:t.Title,disabled:r,title:!0===r?e.noADOConfigToolTip:t.Title,icon:n.a.createElement(V.a,Object(z.a)({extension:a,size:16,imageFileType:"png"}))};s.push(i)}));var o={value:a.ParentTitle,label:a.ParentTitle,disabled:r,title:!0===r?e.noADOConfigToolTip:a.ParentTitle,children:s};e.ipkitItems.push(o);var c=e.ipkitItems.length>0?e.ipkitItems.slice(0,5):e.noItemNode,l=[{value:"-2",label:"IPKit",showCheckbox:!1,icon:n.a.createElement(X,{content:e.ipkitToolTip}),children:c}];e.setState({mainParentGroup:l,expanded:["-2"]})}}else{var p=[{value:"-2",label:"IPKit",showCheckbox:!1,icon:n.a.createElement(X,{content:e.ipkitToolTip}),children:e.noItemNode}];e.setState({mainParentGroup:p,expanded:["-2"]})}}),(function(e){console.error(e)}))}},{key:"GetOfferListItems",value:function(){var e=this,t="IPFeedback/GetIPKitandOffersItems?ipKitOfferSite="+this.props.siteUrl+"&sourceName="+this.props.sourceName;this.webapi.GetCampusWebAPI(h.Campus,t).then((function(t){if(console.log(t),null!==t&&void 0!==t&&0!==t.length){if(void 0==t.Message){e.ipItems=t;var a=t,i=t.IPKitOfferRecords,s=[],r=null===a.AdoId||void 0===a.AdoId;i.map((function(t){var a=t.Source.slice(2+(t.Source.lastIndexOf(".")-1>>>0)),i={value:t.Title,label:t.Title,disabled:r,title:!0===r?e.noADOConfigToolTip:t.Title,icon:n.a.createElement(V.a,Object(z.a)({extension:a,size:16,imageFileType:"png"}))};s.push(i)}));var o={value:a.ParentTitle,label:a.ParentTitle,disabled:r,title:!0===r?e.noADOConfigToolTip:a.ParentTitle,children:s};e.offerItems.push(o);var c=e.offerItems.length>0?e.offerItems.slice(0,5):e.noItemNode,l=[{value:"-1",label:"Offers",showCheckbox:!1,icon:n.a.createElement(X,{content:e.offerToolTip}),children:c}];e.setState({mainParentGroup:l,expanded:["-1"]})}}else{var p=[{value:"-1",label:"Offers",showCheckbox:!1,icon:n.a.createElement(X,{content:e.offerToolTip}),children:e.noItemNode}];e.setState({mainParentGroup:p,expanded:["-1"]})}}),(function(e){console.error(e)}))}}]),a}(n.a.Component);function ee(e){var t="existingIpInnerTabContent.tsx",a=n.a.useState(""),i=Object(j.a)(a,2),s=i[0],r=i[1],o=n.a.useState(""),c=Object(j.a)(o,2),l=c[0],p=c[1],d=n.a.useState(!1),u=Object(j.a)(d,2),h=u[0],f=u[1],b=n.a.useState(!1),g=Object(j.a)(b,2),k=g[0],I=g[1],v=n.a.useState(!1),S=Object(j.a)(v,2),T=S[0],E=S[1],C=function(e){try{e.length>=3?(p(e),I(!0),f(!1)):(I(!1),f(!0),E(!1))}catch(a){m.AppInsightsTrackException(ft,"Exception occured at onSearchOnClickHandler(). "+t,a)}};return n.a.createElement("div",null,n.a.createElement("div",{className:"".concat(y.a.selectFilter," selectFilterforAzureBasepage")},n.a.createElement("label",null,"Select IP"),n.a.createElement(X,{content:"internalipkit"===e.sourceName.toLocaleLowerCase()||"ipforumipkit"===e.sourceName.toLocaleLowerCase()?"Select IPKit that you want to give feedback on":"ipforumoffer"===e.sourceName.toLocaleLowerCase()?"Select Offer that you want to give feedback on":"Select any Offer or IPKit related to the engagement or any individual artifacts that you want to give feedback on."}),n.a.createElement("p",null," Only Top 5 IPKits and Offers will be shown. Please make use of the Search box to select Other IPKits and Offers."),n.a.createElement("div",{className:y.a.searchBox},n.a.createElement("div",null,n.a.createElement("i",{className:"ms-Icon ms-Icon--Search",tabIndex:0,onClick:function(){return C(s)},onKeyDown:function(){return C(s)}}),n.a.createElement("input",{placeholder:"Search","aria-label":"Search",type:"text",tabIndex:0,value:s,onChange:function(e){!function(e){try{""===e&&k?(E(!0),f(!1),p(""),r(e),I(!1)):(r(e),E(!1))}catch(a){m.AppInsightsTrackException(ft,"Exception occured at setSearchStringOnChangeEvent(). "+t,a)}}(e.target.value)},onKeyDown:function(e){return function(e){try{"ENTER"===e.key.toUpperCase()&&(C(e.currentTarget.value),e.preventDefault())}catch(a){m.AppInsightsTrackException(ft,"Exception occured at onSearchKeyDownHandler(). "+t,a)}}(e)}}),n.a.createElement("i",{className:"ms-Icon ms-Icon--Clear",tabIndex:0,onClick:function(){return function(){try{k?(p(""),r(""),f(!1),E(!0),I(!1)):(r(""),f(!1),E(!1))}catch(e){m.AppInsightsTrackException(ft,"Exception occured at onSearchCancelClickHandler(). "+t,e)}}()},onKeyDown:function(){return r("")}})),h&&n.a.createElement("span",{style:{color:"red",fontSize:"12px"}},"Type atleast 3 letter to perform this action."))),n.a.createElement("div",{className:y.a.existingTabcontainer},n.a.createElement("div",{className:y.a.leftContent},n.a.createElement("div",{className:y.a.leftInner},n.a.createElement(Q,{siteUrl:e.siteUrl,sourceName:e.sourceName,ipTitle:e.setIPTitle,reset:e.iPReset,searchStr:l,clearResetFlag:T,siteName:e.siteName}))),n.a.createElement("div",{className:y.a.rightContent},n.a.createElement("div",null,n.a.createElement("h3",null,"IP Feedback"),n.a.createElement("div",{className:y.a.rightContentSection},n.a.createElement("p",null,"IP Feedback may only be provided on one Offer, IPKit, or General Domain at a time. After you have submitted your feedback and the confirmation message appears, the screen will automatically revert back to this IP Feedback home page. If you would like to provide additional feedback on other items, simply follow the screen instructions to do so. Repeat these steps until you have submitted feedback on all desired items."),n.a.createElement("img",{width:"170",height:"177",src:B.a,alt:"Manage IP Feedback Pen"}))))))}var te=a(11),ae=a(239),ie=a(233),ne=a(225),se=a(20),re=a(15),oe=a(5),ce=[{key:"FeedbackTitle",name:"Feedback Title",fieldName:"Feedback Title",className:y.a.feedbackListTd,minWidth:350,maxWidth:350,isResizable:!0,isSorted:!0,isSortedDescending:!1,sortAscendingAriaLabel:"Sorted A to Z",sortDescendingAriaLabel:"Sorted Z to A",data:"string",isPadded:!0},{key:"CreatedDate",name:"Created",fieldName:"Created",className:y.a.feedbackListTd,minWidth:70,maxWidth:70,isResizable:!1,data:"number",isPadded:!0},{key:"IPKit/Offer",name:"IPKit/Offer",fieldName:"IPKit/Offer",className:y.a.feedbackListTd,minWidth:350,maxWidth:350,isResizable:!0,data:"string",isPadded:!0},{key:"Status",name:"Status",fieldName:"Status",className:y.a.feedbackListTd,minWidth:90,maxWidth:90,isResizable:!0,data:"string",isPadded:!0},{key:"CreatedBy",name:"CreatedBy",fieldName:"CreatedBy",className:y.a.feedbackListTd,minWidth:150,maxWidth:150,isResizable:!0,data:"string",isPadded:!0},{key:"Tags",name:"Tags",fieldName:"Tags",className:y.a.feedbackListTd,minWidth:150,maxWidth:150,isResizable:!0,data:"string",isPadded:!0}],le=a(241),pe=a(240),de=(Object(oe.D)({fileIconHeaderIcon:{padding:0,fontSize:"16px"},fileIconCell:{textAlign:"center",selectors:{"&:before":{content:".",display:"inline-block",verticalAlign:"middle",height:"100%",width:"0px",visibility:"hidden"}}},fileIconImg:{verticalAlign:"middle",maxHeight:"16px",maxWidth:"16px"},controlWrapper:{display:"flex",flexWrap:"wrap",marginTop:"100px"},exampleToggle:{display:"inline-block",marginBottom:"10px",marginRight:"30px"},selectionDetails:{marginBottom:"20px"}}),{root:{margin:"0 30px 20px 0",maxWidth:"300px"}}),ue={root:[{selectors:{".ms-Spinner-label":{fontSize:"16px"}}}]},me=function(e){Object(I.a)(a,e);var t=Object(v.a)(a);function a(e){var i;return Object(p.a)(this,a),(i=t.call(this,e)).webapi=new N,i.stroageObj=new Z,i.newitems=void 0,i.CUSTOMEVENTNAME="Campus.GetADOFeedBacks",i.workItemIds="workItemIds",i.fileName="myFeedbackList.tsx",i._onChangeText=function(e,t){i.setState({items:t?i.newitems.filter((function(e){return e.fields["System.Title"].toLowerCase().indexOf(t.toLowerCase())>-1})):i.newitems})},i._onColumnClick=function(e,t){if(void 0!==t){var a=i.state,n=a.columns,s=a.items,r=n.slice(),o=r.filter((function(e){return t.key===e.key}))[0];r.forEach((function(e){e===o?(o.isSortedDescending=!o.isSortedDescending,o.isSorted=!0):(e.isSorted=!1,e.isSortedDescending=!0)}));var c=he(s,o.fieldName,o.isSortedDescending);i.setState({columns:r,items:c})}},i.newitems=[],i.state={items:[],showSpinner:!0,HaveItems:!0,ErrorMsg:"",columns:i._buildColumns(ce)},i}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t,a,i,n,s=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null===(t=this.stroageObj.GetSessionStorage(this.workItemIds+this.props.siteName))){e.next=9;break}a=JSON.parse(t),i=[],n=[],a.map((function(e){var t=[];e.IDs.map((function(e){return n.push(e),t.push(e)})),t.length>0&&(s.getWorkItemLists(t,e,i),t=[])})),e.next=11;break;case 9:return e.next=11,this.getLists();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),m.AppInsightsTrackException(this.CUSTOMEVENTNAME,"Exception occured at componentDidMount()."+this.fileName,e.t0);case 16:case"end":return e.stop()}}),e,this,[[0,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"getLists",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t,a=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"IPFeedbackADO/GetWorkIDs",t={ProjectSiteUrl:this.props.url,IsGapFeedback:!1,IsGapMitigate:!1,Source:""!==this.props.sourceName&&void 0!==this.props.sourceName?this.props.sourceName:""},e.prev=2,e.next=5,this.webapi.PostCampusWebAPI(h.Campus,"IPFeedbackADO/GetWorkIDs",JSON.stringify(t)).then((function(e){a.stroageObj.SetSessionStorage(a.workItemIds+a.props.siteName,JSON.stringify(e)),m.AppInsightsTrackEvent(a.CUSTOMEVENTNAME,"Information","API Success:Retrieved Work Items ID","Retrieved Work Items ID for site: "+a.props.url,"");var t=[],i=[];e.map((function(e){var n=[];e.IDs.map((function(e){return i.push(e),n.push(e)})),n.length>0&&(a.getWorkItemLists(n,e,t),n=[])})),0===i.length&&a.setState({showSpinner:!1,ErrorMsg:'No feedback was submitted. Return to the "Feedback on existing IP" tab to submit your feedback.',HaveItems:!1})}),(function(e){console.log("error"),m.AppInsightsTrackException(a.CUSTOMEVENTNAME,"Exception occured at getting work item IDs",e),console.error(e),a.setState({showSpinner:!1,ErrorMsg:"Oops..Something went wrong",HaveItems:!1})}));case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),m.AppInsightsTrackException(this.CUSTOMEVENTNAME,"Exception occured at retreiving Work Items",e.t0);case 10:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"_sliceWorkitemId",value:function(e,t,a){return e.substring(e.indexOf(t)+t.length,e.indexOf(a)).trim()}},{key:"getWorkItemLists",value:function(){var e=Object(g.a)(b.a.mark((function e(t,a,i){var n,s,r,o=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n=t,s=a.AdoId,r="/_apis/wit/workitems?ids="+t+"&fields=System.Title,System.CreatedBy,System.CreatedDate,System.Tags,"+a.CustomTitle+",System.State&api-version=5.1",this.webapi.GetCampusADOlists(a.AdoOrg,r).then((function(e){if(e.hasOwnProperty("message")){if(e.message.includes("does not exist")){var t=Number(o._sliceWorkitemId(e.message.toLowerCase(),"work item","does not exist")),r=n.indexOf(t);return void(-1!=r&&(n.splice(r,1),n.length>0&&o.getWorkItemLists(n,a,i),0!=t&&0!=s&&o.DeleteWorkItem(t,s)))}if(e.message.includes("not authorized to access this resource"))return void o.setState({HaveItems:!1,showSpinner:!1,ErrorMsg:"Uh-oh, you do not have access for ADO Instance"})}else e.value.map((function(e){var t={fields:{"System.Title":"","System.CreatedDate":"","Custom.IPKitorOfferTitle":"","System.State":"","System.CreatedBy":"","System.Tags":""},id:"",rev:"",url:""};t.fields["Custom.IPKitorOfferTitle"]=e.fields[a.CustomTitle],t.fields["System.State"]=e.fields["System.State"],t.fields["System.CreatedDate"]=e.fields["System.CreatedDate"],t.fields["System.Title"]=e.fields["System.Title"],t.fields["System.CreatedBy"]=e.fields["System.CreatedBy"].displayName,t.fields["System.Tags"]=void 0===typeof e.fields["System.Tags"]?"":e.fields["System.Tags"],t.id=e.id,t.rev=e.rev,t.url=e.url,i.push(t)})),o.newitems=i,i=he(i,"Created",!0),m.AppInsightsTrackEvent(o.CUSTOMEVENTNAME,"Information","API Success:Retrieved Work Items details for the provided IDs","Retrieved Work Items details for the provided IDs: "+n,""),o.setState({items:i,HaveItems:!1,showSpinner:!1})}),(function(e){m.AppInsightsTrackException(o.CUSTOMEVENTNAME,"Exception occured at getting work items for the Given IDs",e),o.setState({showSpinner:!1,ErrorMsg:"Oops..Something went wrong",HaveItems:!1})}))}catch(c){m.AppInsightsTrackException(this.CUSTOMEVENTNAME,"Exception occured at getWorkItemLists",c)}case 1:case"end":return e.stop()}}),e,this)})));return function(t,a,i){return e.apply(this,arguments)}}()},{key:"DeleteWorkItem",value:function(){var e=Object(g.a)(b.a.mark((function e(t,a){var i,n=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i="IPFeedbackADO/DeleteWorkItemFromDB?WorkItemId="+t+"&AdoId="+a,e.next=4,this.webapi.PostCampusWebAPI(h.Campus,i).then((function(e){m.AppInsightsTrackEvent(n.CUSTOMEVENTNAME,"Information","API Success:Deleted Work Items from DB",e,"")}),(function(e){m.AppInsightsTrackException(n.CUSTOMEVENTNAME,"Exception occured at Delete work item from DB",e)}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),m.AppInsightsTrackException(this.CUSTOMEVENTNAME,"Exception occured at Delete Work Items from DB",e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.columns,a=e.items,i=e.HaveItems;return n.a.createElement(ie.a,{className:y.a.feedbacklistContainer},n.a.createElement("div",{className:"".concat(y.a.feedbackListControl)},n.a.createElement("label",null,"Feedback"),n.a.createElement(le.a,{placeholder:"Filter by Title",iconProps:{iconName:"Filter"},onChange:this._onChangeText,styles:de})),a.length>0?n.a.createElement(ne.a,{items:a,className:y.a.feedbackDetailList,setKey:"set",columns:t,onColumnHeaderClick:this._onColumnClick,selectionMode:se.b.none,layoutMode:re.e.justified,isHeaderVisible:!0}):i?n.a.createElement(pe.a,{className:y.a.feebackSpinner,styles:ue,label:"Loading...",ariaLive:"assertive",labelPosition:"right",style:{display:(this.state.showSpinner,"flex")}}):n.a.createElement(ae.a,{className:y.a.nofeedbacksmsg,messageBarType:te.a.warning},this.state.ErrorMsg))}},{key:"_buildColumns",value:function(e){if(0===e.length)return e;var t=e.filter((function(e){return"FeedbackTitle"===e.key}))[0],a=e.filter((function(e){return"CreatedDate"===e.key}))[0],i=e.filter((function(e){return"IPKit/Offer"===e.key}))[0],s=e.filter((function(e){return"Status"===e.key}))[0],r=e.filter((function(e){return"CreatedBy"===e.key}))[0],o=e.filter((function(e){return"Tags"===e.key}))[0];return void 0===t||void 0===a||void 0===i||void 0===s||(t.onRender=function(e){var t=e.url.replace("apis/wit/workItems","workitems/edit");return n.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer",title:e.fields["System.Title"]},e.fields["System.Title"])},a.onRender=function(e){var t=e.fields["System.CreatedDate"],a=new Intl.DateTimeFormat("en-US",{year:"2-digit",month:"numeric",day:"2-digit"}).format(new Date(t));return n.a.createElement("span",null,a)},i.onRender=function(e){return n.a.createElement("span",{title:e.fields["Custom.IPKitorOfferTitle"]},e.fields["Custom.IPKitorOfferTitle"])},s.onRender=function(e){return n.a.createElement("span",null,e.fields["System.State"])},r.onRender=function(e){return n.a.createElement("span",{title:e.fields["System.CreatedBy"]},e.fields["System.CreatedBy"])},o.onRender=function(e){return n.a.createElement("span",{title:e.fields["System.Tags"]},e.fields["System.Tags"])}),e}},{key:"_onItemInvoked",value:function(e){alert("Item invoked: ".concat(e.name))}}]),a}(n.a.Component);function he(e,t,a){var i={"Feedback Title":"System.Title",Created:"System.CreatedDate","IPKit/Offer":"Custom.IPKitorOfferTitle",Status:"System.State",CreatedBy:"System.CreatedBy",Tags:"System.Tags"}[t];return e.slice(0).sort((function(e,t){return"undefined"===typeof e.fields[i]?1:"undefined"===typeof t.fields[i]?-1:(e=(e.fields[i]||"").toLowerCase(),t=(t.fields[i]||"").toLowerCase(),(a?e<t:e>t)?1:-1)}))}var fe,be,ge,ke,Ie=a(36);!function(e){e[e.notInitiated=0]="notInitiated",e[e.architectAssigned=1]="architectAssigned",e[e.completed=2]="completed",e[e.loginByArchitect=3]="loginByArchitect",e[e.invalid=99]="invalid"}(fe||(fe={})),function(e){e[e.projectStartup=1]="projectStartup",e[e.projectCloseOut=2]="projectCloseOut",e[e.assignIPFeedback=3]="assignIPFeedback",e[e.allFeedback=4]="allFeedback"}(be||(be={})),function(e){e[e.StartUp=1]="StartUp",e[e.CloseOut=2]="CloseOut",e[e.IPFeedback=3]="IPFeedback"}(ge||(ge={})),function(e){e[e.LeadArchitect=1]="LeadArchitect",e[e.BackUpArchitect=2]="BackUpArchitect"}(ke||(ke={}));var ve,Se=function(e){Object(I.a)(a,e);var t=Object(v.a)(a);function a(e){var i;return Object(p.a)(this,a),(i=t.call(this,e)).fileName="ManageIPFeedbackBtn.tsx",i.idPrefix="IpFeedBack-",i.menuProps={options:[{key:"1",name:"AssignIPFeedback",text:"Assign IP Feedback",iconName:"Assign",isActive:!1},{key:"2",name:"CancelIPFeedbackAssignment",text:"Cancel IP Feedback Assignment",iconName:"AlbumRemove",isActive:!1}]},i.handleClickOutside=function(e){var t=r.a.findDOMNode(Object(k.a)(i));t&&t.contains(e.target)||(i.setState({showSensitiveMenu:!1}),i.props.resetActiveClass(!0))},i.state={showSensitiveMenu:!1,SensitiveMenu:i.menuProps,Sensitivity:i.props.InitialSensitivity,isActiveTab:i.props.isActive},i}return Object(d.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside,!0)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside,!0)}},{key:"render",value:function(){var e=this,t=this.props.ipFeedbackSurveyStatus===fe.architectAssigned,a=this.props.ipFeedbackSurveyStatus===fe.invalid;return n.a.createElement("span",{className:"".concat(y.a.tabOptionButton," ").concat(this.state.isActiveTab?y.a.tabActive:""),role:"tab","aria-selected":this.state.isActiveTab,title:"Manage IP Feedback Assignment","aria-haspopup":"true",tabIndex:0,id:"".concat(this.idPrefix,"-SensitivityMenuBtn"),onClick:this.onSensitivityBtnClick.bind(this),onKeyDown:this.onSensitivityBtnKeydown.bind(this)},n.a.createElement("span",{tabIndex:-1},"Manage IP Feedback Assignment",n.a.createElement("span",null,n.a.createElement(V.a,{iconName:"ChevronDown","aria-hidden":"true"}))),n.a.createElement("ul",{"aria-labelledby":"".concat(this.idPrefix,"-SensitivityMenuBtn"),role:"listbox","aria-expanded":this.state.showSensitiveMenu?"true":"false",style:{display:this.state.showSensitiveMenu?"block":"none"}},this.props.tabSpinner?n.a.createElement(pe.a,{size:Ie.a.small}):this.state.SensitiveMenu.options.map((function(i,s){return i.name.toUpperCase()===e.menuProps.options[0].name.toUpperCase()?n.a.createElement("li",{tabIndex:t?-1:0,"aria-disabled":t,role:"option","aria-selected":i.isActive?"true":"false",key:i.name,id:i.name,className:"".concat(t?y.a.disabledClass:""),title:t?"":i.text,onClick:e._onSensitivityLiClick.bind(e),onKeyDown:e._onSensitivityLiKeydown.bind(e)},n.a.createElement("span",null,i.text)):n.a.createElement("li",{tabIndex:a?-1:0,"aria-disabled":a,role:"option","aria-selected":i.isActive?"true":"false",key:i.name,id:i.name,className:"".concat(a?y.a.disabledClass:""),title:a?"":i.text,onClick:e._onSensitivityLiClick.bind(e),onKeyDown:e._onSensitivityLiKeydown.bind(e)},n.a.createElement("span",null,i.text))}))))}},{key:"onSensitivityBtnKeydown",value:function(e){try{if("ENTER"===e.key.toUpperCase()){var t;this.setState({showSensitiveMenu:!this.state.showSensitiveMenu}),this.props.resetActiveClass(!1);var a=null!==(t=e.currentTarget.getAttribute("id"))&&void 0!==t?t:"";m.AppInsightsTrackEvent(ft,"Information",this.fileName,"Send Sensitivity Button Click()",a)}}catch(i){m.AppInsightsTrackException(ft,"Exception occured at onSensitivityBtnKeydown(). "+this.fileName,i)}}},{key:"onSensitivityBtnClick",value:function(e){try{var t;this.setState({showSensitiveMenu:!this.state.showSensitiveMenu}),this.props.resetActiveClass(!1);var a=null!==(t=e.currentTarget.getAttribute("id"))&&void 0!==t?t:"";m.AppInsightsTrackEvent(ft,"Information",this.fileName,"Send Sensitivity Button Click()",a)}catch(i){m.AppInsightsTrackException(ft,"Exception occured at onSensitivityBtnClick(). "+this.fileName,i)}}},{key:"_onSensitivityLiKeydown",value:function(e){try{if("ENTER"===e.key.toLocaleUpperCase()){var t,a=Object(L.a)({},this.state.SensitiveMenu);a.options.forEach((function(e){e.isActive=!1})),"Assign IP Feedback"===e.currentTarget.title?(a.options.filter((function(e){return"Assign IP Feedback"===e.text}))[0].isActive=!0,this.setState({SensitiveMenu:a,Sensitivity:1}),this.props.setParentSensitivity(1)):(a.options.filter((function(e){return"Cancel IP Feedback Assignment"===e.text}))[0].isActive=!0,this.setState({SensitiveMenu:a,Sensitivity:2}),this.props.setParentSensitivity(2));var i=null!==(t=e.currentTarget.getAttribute("id"))&&void 0!==t?t:"";m.AppInsightsTrackEvent(ft,"Information",this.fileName,"Sensitivity Click.",i)}}catch(n){m.AppInsightsTrackException(ft,"Exception occured at _onSensitivityLiKeydown(). "+this.fileName,n)}}},{key:"_onSensitivityLiClick",value:function(e){try{var t,a=Object(L.a)({},this.state.SensitiveMenu);a.options.forEach((function(e){e.isActive=!1})),"Assign IP Feedback"===e.currentTarget.title?(a.options.filter((function(e){return"Assign IP Feedback"===e.text}))[0].isActive=!0,this.setState({SensitiveMenu:a,Sensitivity:1}),this.props.setParentSensitivity(1)):(a.options.filter((function(e){return"Cancel IP Feedback Assignment"===e.text}))[0].isActive=!0,this.setState({SensitiveMenu:a,Sensitivity:2}),this.props.setParentSensitivity(2));var i=null!==(t=e.currentTarget.getAttribute("id"))&&void 0!==t?t:"";m.AppInsightsTrackEvent(ft,"Information",this.fileName,"Sensitivity Click.",i)}catch(n){m.AppInsightsTrackException(ft,"Exception occured at _onSensitivityLiClick(). "+this.fileName,n)}}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=Object(L.a)({},t);return a.isActiveTab=e.isActive,a}}]),a}(i.Component),ye=a(29),Te=a.n(ye),Ee=function(e){Object(I.a)(a,e);var t=Object(v.a)(a);function a(){return Object(p.a)(this,a),t.apply(this,arguments)}return Object(d.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{className:Te.a.surveyBoxContainer,style:{width:this.props.surveyContainerwidth}},this.props.infoIconVisible&&n.a.createElement("i",{className:"ms-Icon ms-Icon--Completed"}),n.a.createElement("span",{className:Te.a.surveyMsg},this.props.messageContent," ",this.props.isMandatory&&n.a.createElement("b",null,"*")),n.a.createElement("div",{className:Te.a.surveyRightPart},this.props.actions))}}]),a}(n.a.Component),Ce=a(224),Ae=a(118),Pe=a(55),Oe=a.n(Pe),xe={clientId:"e0f60ff0-327b-43e2-9055-54782bbed141",tenant:"microsoft.onmicrosoft.com",endpoints:{graphApiUri:"https://graph.microsoft.com"},postLogoutRedirectUri:window.location.origin,cacheLocation:"sessionStorage"},we=new T.AuthenticationContext(xe);!function(e){e.MSGraph="https://graph.microsoft.com"}(ve||(ve={}));Object(T.withAdalLogin)(we,xe.endpoints.graphApiUri);var De=function(){function e(){Object(p.a)(this,e),this.graphUrl="https://graph.microsoft.com/"}return Object(d.a)(e,[{key:"getPeople",value:function(){var e=this;return new Promise((function(t,a){var i;try{i=e.graphUrl+"v1.0/me/people?$filter=(personType/class eq 'Person')&$select=displayName,givenName,surname,userPrincipalName,scoredEmailAddresses&$top=20",t(Object(T.adalFetch)(we,xe.endpoints.graphApiUri,fetch,i,{method:"GET",headers:{Accept:"application/json, text/plain, */*","Content-type":"application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8"}}).then((function(e){return e.json()})))}catch(n){console.log(n.code+" - "+n.message),a(n)}}))}},{key:"searchForPeoples",value:function(e){var t=this;return new Promise((function(a,i){var n,s={method:"POST",body:JSON.stringify({ids:e,types:["user"]}),headers:{Accept:"application/json, text/plain, */*","Content-type":"application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8"}};try{n=t.graphUrl+"v1.0/directoryObjects/getByIds",a(Object(T.adalFetch)(we,xe.endpoints.graphApiUri,fetch,n,s).then((function(e){return e.json()})))}catch(r){console.log(r.code+" - "+r.message),i(r)}}))}},{key:"searchForPeople",value:function(e){var t=this;return new Promise((function(a,i){var n;try{n=t.graphUrl+"v1.0/users?$filter=(startswith(displayName,'"+e+"') or startswith(mail,'"+e+"') or startswith(userPrincipalName,'"+e+"'))&$select=displayName,givenName,surname,userPrincipalName,mail",a(Object(T.adalFetch)(we,xe.endpoints.graphApiUri,fetch,n,{method:"GET",headers:{Accept:"application/json, text/plain, */*","Content-type":"application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8"}}).then((function(e){return e.json()})))}catch(s){console.log(s.code+" - "+s.message),i(s)}}))}}]),e}(),Ne=a(227),Fe=a(3);Object(H.a)();var Me=function(e){Object(I.a)(a,e);var t=Object(v.a)(a);function a(e){var i;return Object(p.a)(this,a),(i=t.call(this,e))._peopleList=void 0,i._searchResults=[],i._defaultselectedUsers=[],i.sdkHelper=new De,i._onGetMoreResults=function(e,t,a){return i.setState({isLoadingPeople:!0}),i.sdkHelper.searchForPeople(e).then(function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=3;break}return console.error(t.error),e.abrupt("return",!1);case 3:return i._searchResults=i._mapUsersToPersonas(t,!0),i.setState({isLoadingPeople:!1}),e.abrupt("return",i._searchResults);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){console.error(e)}))},i._showError=i._showError.bind(Object(k.a)(i)),i.state={selectedPeople:[],isLoadingPeople:!0,isLoadingPics:!0},i}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(this.props.selectedPerson.length>0)){e.next=4;break}return e.next=4,this.sdkHelper.searchForPeople(this.props.selectedPerson).then(function(){var e=Object(g.a)(b.a.mark((function e(a){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.error){e.next=3;break}return console.error(a.error),e.abrupt("return",!1);case 3:t._defaultselectedUsers=t._mapUsersToPersonas(a,!0),t.props.selectedPersonData(t._defaultselectedUsers),t.setState({isLoadingPeople:!1});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){console.error(e)}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(){var e=Object(g.a)(b.a.mark((function e(t){var a=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(t.selectedPerson.length>0&&this.props.selectedPerson!==t.selectedPerson)){e.next=6;break}return e.next=4,this.sdkHelper.searchForPeople(t.selectedPerson).then(function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.error){e.next=3;break}return console.error(t.error),e.abrupt("return",!1);case 3:a._defaultselectedUsers=a._mapUsersToPersonas(t,!0),a.props.selectedPersonData(a._defaultselectedUsers),a.setState({isLoadingPeople:!1});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){console.error(e)}));case 4:e.next=7;break;case 6:0===t.selectedPerson.length?(this._defaultselectedUsers=[],this.setState({isLoadingPeople:!1})):this.setState({isLoadingPeople:!1});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_mapUsersToPersonas",value:function(e,t){try{if(void 0!==e.value&&e.value.length>0)return e.value.map((function(e){var a=t?e.mail:e.scoredEmailAddresses[0].address,i={};return i.primaryText=e.displayName,i.secondaryText=a||e.userPrincipalName,i.presence=Fe.b.none,i.imageInitials=e.givenName&&e.surname?e.givenName.substring(0,1)+e.surname.substring(0,1):e.displayName.substring(0,1),i.initialsColor=Math.floor(15*Math.random())+0,i.optionalText=e.givenName,i}))}catch(a){console.error(a)}}},{key:"_onFilterChanged",value:function(){var e=Object(g.a)(b.a.mark((function e(t,a){var i=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this._peopleList){e.next=5;break}return e.abrupt("return",t?this._peopleList.concat(this._searchResults).filter((function(e){return 0===e.primaryText.toLowerCase().indexOf(t.toLowerCase())})).filter((function(e){return!i._listContainsPersona(e,a)})):[]);case 5:return e.next=7,this.sdkHelper.getPeople().then(function(){var e=Object(g.a)(b.a.mark((function e(n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i._peopleList=i._mapUsersToPersonas(n,!1),!n.error){e.next=4;break}return console.error(n.error),e.abrupt("return",!1);case 4:void 0!==i._peopleList&&i._peopleList.length>0&&i._peopleList.concat(i._searchResults).filter((function(e){return 0===e.primaryText.toLowerCase().indexOf(t.toLowerCase())})).filter((function(e){return!i._listContainsPersona(e,a)}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){console.error(e)}));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"_listContainsPersona",value:function(e,t){try{return!(!t||!t.length||0===t.length)&&t.filter((function(t){return t.primaryText===e.primaryText})).length>0}catch(a){console.error(a)}}},{key:"_onSelectionChanged",value:function(e){try{this._defaultselectedUsers=e.filter((function(t,a){return a===e.findIndex((function(e){return e.secondaryText.toLowerCase()===t.secondaryText.toLowerCase()}))})),this.props.selectedPeople(e),this.setState({result:null,selectedPeople:e})}catch(t){console.error(t)}}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement(Ne.a,{onResolveSuggestions:this._onFilterChanged.bind(this),pickerSuggestionsProps:{suggestionsHeaderText:"Suggested People",noResultsFoundText:"No results found",searchForMoreText:"Search",loadingText:"Loading...",suggestionsContainerAriaLabel:"Suggested contacts"},getTextFromItem:function(e){return e.primaryText},onChange:this._onSelectionChanged.bind(this),onGetMoreResults:this._onGetMoreResults.bind(this),itemLimit:this.props.allowMultiple?void 0:1,selectedItems:this._defaultselectedUsers,className:"ms-PeoplePicker",key:"normal-people-picker",removeButtonAriaLabel:"Remove",inputProps:{"aria-label":"People Picker"},styles:{text:{selectors:{":focus":{borderColor:"rgb(0, 150, 136)"},":active":{borderColor:"rgb(0, 150, 136)"},":focus-within":{borderColor:"rgb(0, 150, 136)"},":visited":{borderColor:"rgb(0, 150, 136)"}}}}}),this.state.result&&n.a.createElement(ae.a,{messageBarType:this.state.result.type},this.state.result.text))}},{key:"_showError",value:function(e){this.setState({result:{type:te.a.error,text:"Error ".concat(e.statusCode,": ").concat(e.code," - ").concat(e.message)}})}}]),a}(n.a.Component),Ue={root:[{selectors:{".ms-Spinner-label":{fontSize:"16px"}}}]},je=function(e){Object(I.a)(a,e);var t=Object(v.a)(a);function a(e){var i;return Object(p.a)(this,a),(i=t.call(this,e)).IPFeedbackTooltip="Please note that the assigned Architect needs to be given access to the Project in order to initiate the Survey.",i.LeadArcContent="Please assign a Lead Architect or Consultant to respond to the IP Feedback.",i.BackupArcContent="Please assign a Backup Architect or Consultant to respond to the IP Feedback.",i.webapi=new N,i.stroageObj=new Z,i.activeSurveyDetails="ActiveSurveyDetails",i.engagementIPSurveyStatusValues=fe.architectAssigned,i.success="success",i.failed="failed",i.managerEmailID={name:F(),email:U()},i.selectedLeadHandler=function(e){try{var t=[];e.map((function(e,a){return t.push({name:e.optionalText,email:e.secondaryText,role:ke.LeadArchitect,displayName:e.primaryText}),t})),e.length>0&&i.state.backUpArchitectName.length>0?i.setState({buttonVisible:!0,leadArchitectName:t}):i.setState({buttonVisible:!1,leadArchitectName:t})}catch(a){m.AppInsightsTrackException(ft,"Exception occured at selectedLeadHandler() in AssignIPFeedbackSurvey. ",a)}},i.selectedLeadHandlerData=function(e){try{var t=[];e.map((function(e,a){return t.push({name:e.optionalText,email:e.secondaryText,role:ke.LeadArchitect,displayName:e.primaryText}),t})),i.setState({leadArchitectName:t})}catch(a){m.AppInsightsTrackException(ft,"Exception occured at selectedLeadHandler() in AssignIPFeedbackSurvey. ",a)}},i.selectedBackUpHandler=function(e){try{var t=[];e.map((function(e){return t.push({name:e.optionalText,email:e.secondaryText,role:ke.BackUpArchitect,displayName:e.primaryText}),t})),e.length>0&&i.state.leadArchitectName.length>0?i.setState({buttonVisible:!0,backUpArchitectName:t}):i.setState({buttonVisible:!1,backUpArchitectName:t})}catch(a){m.AppInsightsTrackException(ft,"Exception occured at selectedBackUpHandler() in AssignIPFeedbackSurvey. ",a)}},i.selectedBackUpHandlerData=function(e){try{var t=[];e.map((function(e){return t.push({name:e.optionalText,email:e.secondaryText,role:ke.BackUpArchitect,displayName:e.primaryText}),t})),i.setState({backUpArchitectName:t})}catch(a){m.AppInsightsTrackException(ft,"Exception occured at selectedBackUpHandler() in AssignIPFeedbackSurvey. ",a)}},i._submitClick=Object(g.a)(b.a.mark((function e(){var t,a,n,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.setState({showSpinner:!0}),t=i.state.leadArchitectName,"EngagementIPSurvey/CreateIpFeedbackAssignMent",a={ProjectSite:i.state.projectSite,ArchitectNames:t.concat(i.state.backUpArchitectName),ManagerName:i.state.managerEmailID,EngagementIPSurveyStatusValues:i.engagementIPSurveyStatusValues,IPSurveyStatusValues:ge.IPFeedback},(n=[]).push(i.state.leadArchitectName[0].displayName),n.push(i.state.backUpArchitectName[0].displayName),e.next=10,i.webapi.PostCampusWebAPI(h.Campus,"EngagementIPSurvey/CreateIpFeedbackAssignMent",JSON.stringify(a)).then((function(e){return null!==e&&e.ManageIPFeedbackAssignmentId>0?(m.AppInsightsTrackEvent(ft,"Information","Project IPFeedback Survey","API Success:On submission click. AssignmentId:"+e.ManageIPFeedbackAssignmentId,""),i.stroageObj.DeleteSessionStorage(i.activeSurveyDetails+i.props.siteName),i.stroageObj.SetSessionStorage(i.activeSurveyDetails+i.props.siteName,JSON.stringify(e)),i.success):i.failed})).catch((function(e){return m.AppInsightsTrackException(ft,"Exception occured on submission click in ProjectIPFeedbackSurvey",e),i.failed}));case 10:s=e.sent,i.props.surveyStatusCallback(i.engagementIPSurveyStatusValues,n,s),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),m.AppInsightsTrackException(ft,"Exception occured at _submitClick() in ProjectIPFeedbackSurvey. ",e.t0);case 17:i.setState({showSpinner:!1}),m.AppInsightsTrackEvent(ft,"Information","Project IPFeedback Survey","Project IPFeedback Submit button clicked","ProjectIPFeedback_SubmitButton");case 19:case"end":return e.stop()}}),e,null,[[0,14]])}))),i._resetClick=function(){m.AppInsightsTrackEvent(ft,"Information","Project IPFeedback Survey","Project IPFeedback Reset button clicked","ProjectIPFeedback_ResetButton"),i.setState({buttonVisible:!1,leadArchitectName:[],backUpArchitectName:[]})},i.state={buttonVisible:!1,projectSite:i.props.url,leadArchitectName:[],backUpArchitectName:[],managerEmailID:i.managerEmailID,showSpinner:!1},i}return Object(d.a)(a,[{key:"render",value:function(){return n.a.createElement("div",null,this.state.showSpinner&&n.a.createElement("div",{className:Oe.a.fullPageCenterSpinner}," ",n.a.createElement(pe.a,{styles:Ue,label:"Processing...",ariaLive:"assertive",labelPosition:"right",size:Ie.a.large})),n.a.createElement("div",{className:"".concat(Oe.a.engagementIpContr," ").concat(Oe.a.startUphome)},n.a.createElement("h4",{className:Oe.a.subTitle},"Assign IP Feedback ",n.a.createElement(X,{content:this.IPFeedbackTooltip})),n.a.createElement(Ee,{messageContent:this.LeadArcContent,isMandatory:!0,actions:this._onLeadAction()}),n.a.createElement(Ee,{messageContent:this.BackupArcContent,isMandatory:!0,actions:this._onBackUpAction()}),n.a.createElement("div",{className:Oe.a.bottomContent},n.a.createElement(Ce.a,{title:"Submit",id:"Engagement_IPFeedback_SubmitButton",onClick:this._submitClick.bind(this),disabled:!this.state.buttonVisible},"   Submit"),n.a.createElement(Ae.a,{title:"Reset",id:"Engagement_IPFeedback_ResetButton",onClick:this._resetClick.bind(this)},"   Cancel"))))}},{key:"_onLeadAction",value:function(){return n.a.createElement(Me,{allowMultiple:!1,selectedPeople:this.selectedLeadHandler,selectedPerson:this.state.leadArchitectName})}},{key:"_onBackUpAction",value:function(){return n.a.createElement(Me,{allowMultiple:!1,selectedPeople:this.selectedBackUpHandler,selectedPerson:this.state.backUpArchitectName})}}]),a}(n.a.Component),_e=a(228),Be=a(231),Le={dropdown:{width:300}},Ke=[{key:"Cancelled",text:"Project Cancelled/Closed"},{key:"OnHold",text:"Project on Hold"},{key:"ResourceChanged",text:"Project Resource Changed"},{key:"Error",text:"Assigned in Error"},{key:"Other",text:"Other"}],Re={root:[{selectors:{".ms-Spinner-label":{fontSize:"16px"}}}]},Ge={childrenGap:40},Ve=function(e){Object(I.a)(a,e);var t=Object(v.a)(a);function a(e){var i;return Object(p.a)(this,a),(i=t.call(this,e)).validataionMessage="Please select the reason for cancellation.",i.cancelReason="",i.enterKeyText="ENTER",i.cancelEvent="cancel",i.loginUserEmail=U(),i.stroageObj=new Z,i.activeSurveyDetails="ActiveSurveyDetails",i.webapi=new N,i.submitEvent="submit",i.catchErrorMessage="OOPs! Something went wrong. Please try again a bit later.",i.onDismissMessageBar=function(){try{i.setState({showMessageBar:!1}),m.AppInsightsTrackEvent(ft,"Information","MessageBar","IP Feedback MessageBar Dismiss button clicked","IpFeedback-CancelAssignment-MessageBar")}catch(e){m.AppInsightsTrackException(ft,"Exception occured at method onDismissMessageBar()",e)}},i.submitClickAPICall=function(){var e=Object(g.a)(b.a.mark((function e(t,a){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={ManageIPFeedbackAssignmentId:a.ManageIPFeedbackAssignmentId,ProjectSiteID:a.ProjectSiteID,ProjectSite:a.ProjectSite,IPFeedbackAssignedBy:a.IPFeedbackAssignedBy,IPFeedbackAssignedByName:a.IPFeedbackAssignedByName,IPFeedbackAssignedDate:a.IPFeedbackAssignedDate,IPFeedbackLeadArchitect:a.IPFeedbackLeadArchitect,IPFeedbackLeadArchitectName:a.IPFeedbackLeadArchitectName,IPFeedbackBackUpArchitect:a.IPFeedbackBackUpArchitect,IPFeedbackBackUpArchitectName:a.IPFeedbackBackUpArchitectName,IPFeedbackStatus:a.IPFeedbackStatus,CancelReason:t,CancelledBy:i.loginUserEmail,CancelledDate:new Date},e.next=4,i.webapi.PostCampusWebAPI(h.Campus,"EngagementIPSurvey/CancelIpFeedbackAssignMent",JSON.stringify(n)).then((function(e){i.stroageObj.DeleteSessionStorage(i.activeSurveyDetails+i.props.siteName),i.props.cancelEvent(i.submitEvent,a),i.setState({showSpinner:!1,showMessageBar:!1,showValidationMessage:!1}),m.AppInsightsTrackEvent(ft,"Information","API Success:submitClickAPICall()",e,"")})).catch((function(e){i.setState({showSpinner:!1,showMessageBar:!0,showValidationMessage:!1,MessageBarType:te.a.error,MessageBarContent:i.catchErrorMessage}),m.AppInsightsTrackException(ft,"Exception occured at API Call submitClickAPICall(). ",e)}));case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),i.setState({showSpinner:!1,showMessageBar:!0,showValidationMessage:!1,MessageBarType:te.a.error,MessageBarContent:i.catchErrorMessage}),m.AppInsightsTrackException(ft,"Exception occured at submitClickAPICall(). ",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}(),i.validationCheck=function(e){var t=!0;try{var a=i.state.showValidationMessage,n=i.state.showMessageBar,s="";""===i.cancelReason&&(t=!1,a=!0),e.ManageIPFeedbackAssignmentId>0||(t=!1,n=!0,s="Could not find valid ip feedback assignments!!"),t||i.setState({showValidationMessage:a,showMessageBar:n,MessageBarContent:s,MessageBarType:te.a.error})}catch(r){m.AppInsightsTrackException(ft,"Exception occured at validationCheck(). ",r)}return t},i.onSubmitClickEvent=function(e){try{if(!i.validationCheck(i.props.currentSurveryDetails))return;i.setState({showValidationMessage:!1,showSpinner:!0}),i.submitClickAPICall(i.cancelReason,i.props.currentSurveryDetails),m.AppInsightsTrackEvent(ft,"Information","Submit Button","Submit Button KeyBoard Enter Key Event, CancelAssignment page.",e.currentTarget.id)}catch(t){m.AppInsightsTrackException(ft,"Exception occured at onSubmitClickEvent(). ",t)}},i.onSubmitKeydownEvent=function(e){try{if(e.key.toUpperCase()===i.enterKeyText){if(!i.validationCheck(i.props.currentSurveryDetails))return;i.setState({showValidationMessage:!1,showSpinner:!0}),i.submitClickAPICall(i.cancelReason,i.props.currentSurveryDetails),m.AppInsightsTrackEvent(ft,"Information","Submit Button","Submit Button Click Event, CancelAssignment page.",e.currentTarget.id)}}catch(t){m.AppInsightsTrackException(ft,"Exception occured at onSubmitKeydownEvent(). ",t)}},i.onChangeDropDownEvent=function(e,t,a){try{t&&(i.cancelReason=t.text,i.setState({showValidationMessage:!1}),m.AppInsightsTrackEvent(ft,"Information","Cancel DropDown",i.cancelReason+" has been selected in Cancellation reason Dropdown. CancelAssignment page.",e.currentTarget.id))}catch(n){m.AppInsightsTrackException(ft,"Exception occured at onChangeDropDownEvent(). ",n)}},i.onCancelClickEvent=function(e){try{i.setState({showValidationMessage:!1}),i.cancelReason="",i.props.cancelEvent(i.cancelEvent,i.props.currentSurveryDetails),m.AppInsightsTrackEvent(ft,"Information","Cancel Button","Cancel Button Click Event. CancelAssignment page.",e.currentTarget.id)}catch(t){m.AppInsightsTrackException(ft,"Exception occured at onCancelClickEvent(). ",t)}},i.onCancelKeydownEvent=function(e){try{e.key.toUpperCase()===i.enterKeyText&&(i.setState({showValidationMessage:!1}),i.cancelReason="",i.props.cancelEvent(i.cancelEvent,i.props.currentSurveryDetails),m.AppInsightsTrackEvent(ft,"Information","Cancel Button","Cancel Button Enter Key Event, CancelAssignment page.",e.currentTarget.id))}catch(t){m.AppInsightsTrackException(ft,"Exception occured at onCancelKeydownEvent(). ",t)}},i.state={showValidationMessage:!1,showMessageBar:!1,MessageBarContent:"",MessageBarType:te.a.success,showSpinner:!1},i}return Object(d.a)(a,[{key:"render",value:function(){return n.a.createElement("div",{className:Te.a.cancelIpFeedback},this.state.showSpinner&&n.a.createElement("div",{className:Te.a.pageCenterSpinner},n.a.createElement(pe.a,{styles:Re,label:"Processing...",ariaLive:"assertive",labelPosition:"right",size:Ie.a.large})),this.state.showMessageBar&&n.a.createElement(ae.a,{messageBarType:this.state.MessageBarType,onDismiss:this.onDismissMessageBar.bind(this),id:"IpFeedback-CancelAssignment-MessageBar",dismissButtonAriaLabel:"close"},this.state.MessageBarContent),n.a.createElement("div",{className:Te.a.surveyBoxContainer},n.a.createElement("span",{className:Te.a.surveyMsg},"Please select the reason for IP Feedback assignment cancellation.",n.a.createElement("b",null,"*")),n.a.createElement("div",{className:Te.a.surveyRightPart},n.a.createElement(_e.a,{placeholder:"Select an option",id:"IpFeedback-CancelAssignment-DropDown",options:Ke,styles:Le,errorMessage:this.state.showValidationMessage?this.validataionMessage:void 0,onChange:this.onChangeDropDownEvent.bind(this)}))),n.a.createElement("div",null,n.a.createElement(Be.a,{horizontal:!0,tokens:Ge,className:Te.a.bottomContent},n.a.createElement(Ce.a,{text:"Submit",onClick:this.onSubmitClickEvent.bind(this),onKeyDown:this.onSubmitKeydownEvent.bind(this),id:"IpFeedback-CancelAssignment-SubmitBtn"},"Submit"),n.a.createElement(Ae.a,{text:"Cancel",onClick:this.onCancelClickEvent.bind(this),onKeyDown:this.onCancelKeydownEvent.bind(this),id:"IpFeedback-CancelAssignment-CancelBtn"},"Cancel"))))}}]),a}(i.Component),We=(a(92),a(229)),ze=a(21),He=a(235),Je=a(119),qe=a(114),Xe=a.n(qe);Object(H.a)(),Object(W.a)();var $e=function(e){Object(I.a)(a,e);var t=Object(v.a)(a);function a(e){var i;return Object(p.a)(this,a),(i=t.call(this,e)).CUSTOMEVENTNAME="IpFeedBack-Attachment",i.AttachmentErrorMgs="Please select .docx or .pdf file extension!",i.AttachmentSizeErrorMgs="Please select a file less than 10mb!",i.webapi=new N,i.fileName="Attachment.tsx",i.prjCacheKey="IpFeedback-AttachmentSize",i.cacheExpirationTimeStamp=36e5,i.DivisorByte=1024,i.UserLogin="",i.maxFileSize=0,i.validationFileSize="",i.getIcon=function(e){try{return e.substring(e.lastIndexOf(".")+1)}catch(t){m.AppInsightsTrackEvent(i.CUSTOMEVENTNAME,"Error","getIcon()","Error in getIcon  | Attachment.tsx | "+t,"")}},i.handleFiles=function(e){try{var t,a=i.state.Files;Object.keys(e.fileList).map((function(n){t={fileName:e.fileList[n].name,fileSize:e.fileList[n].size,fileType:e.fileList[n].type,base64Str:e.fileList[n]},a.push(t);i.getIcon(e.fileList[n].name);Number(e.fileList[n].size/i.DivisorByte)>i.maxFileSize?(a.pop(),i.setState({Files:a,IsErrFileSize:!0})):(i.setState({Files:a,IsErrMgsVisible:!1,IsErrFileSize:!1}),i.props.Attachments(i.state.Files)),m.AppInsightsTrackEvent(i.CUSTOMEVENTNAME,"Information","ClickEvent","Browse Button was clicked in the Ip-Feedback Page. ","handleFiles")}))}catch(n){m.AppInsightsTrackEvent(i.CUSTOMEVENTNAME,"Error","handleFiles()","Error in handleFiles  | Attachment.tsx | "+n,"")}},i.handleCloseClick=function(e){try{var t=e.currentTarget.getAttribute("file-name"),a=i.state.Files.findIndex((function(e){return e.fileName===t}));-1!==a&&i.state.Files.splice(a,1),i.setState({Files:i.state.Files}),m.AppInsightsTrackEvent(i.CUSTOMEVENTNAME,"Information","ClickEvent","Attachment Close Button was clicked in the ip-feedback page. ","handleCloseClick")}catch(n){m.AppInsightsTrackEvent(i.CUSTOMEVENTNAME,"Error","handleCloseClick()","Error in handleCloseClick  | Attachment.tsx | "+n,"")}},i.convertBitsToKb=function(e){try{return Number(e)/i.DivisorByte>i.DivisorByte?(Number(e)/i.DivisorByte/i.DivisorByte).toFixed(2):(Number(e)/i.DivisorByte).toFixed(2)}catch(t){m.AppInsightsTrackEvent(i.CUSTOMEVENTNAME,"Error","convertBitsToKb()","Error in convertBitsToKb  | Attachment.tsx | "+t,"")}},i.getFileSizeExtension=function(e){try{return Number(e)/i.DivisorByte>i.DivisorByte?"MB":"KB"}catch(t){m.AppInsightsTrackEvent(i.CUSTOMEVENTNAME,"Error","convertBitsToKb()","Error in convertBitsToKb  | Attachment.tsx | "+t,"")}},i.state={Files:[],IsErrMgsVisible:!1,IsErrFileSize:!1},i}return Object(d.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState({Files:e.fromParentToChild,IsErrMgsVisible:!1,IsErrFileSize:!1})}},{key:"componentDidMount",value:function(){var e=this;this.UserLogin=M();var t=this.fetchCache(this.prjCacheKey,this.UserLogin);t?(this.maxFileSize=t*this.DivisorByte,this.validationFileSize=t.toString()):this.webapi.GetCampusWebAPI(h.Campus,"IPFeedback/GetConfigurationValue?Name=ipfeedback").then((function(t){var a=Number(t);e.validationFileSize=t,e.maxFileSize=a*e.DivisorByte,e.saveInCache(e.prjCacheKey,a,e.UserLogin)})).catch((function(t){m.AppInsightsTrackException(e.CUSTOMEVENTNAME,"Exception occured at componentDidMount api Call GetConfigurationValue. "+e.fileName,t)}))}},{key:"render",value:function(){var e=this,t=this.state.Files.length;return n.a.createElement("div",{className:y.a.attachmentContainer},n.a.createElement("label",null,"Attachments"),n.a.createElement("div",{className:y.a.attachmentInner},t>0&&n.a.createElement("ul",null,this.state.Files.map((function(t,a){return n.a.createElement("li",{className:y.a.attachmentList,key:a},n.a.createElement(V.a,Object(z.a)({extension:e.getIcon(t.fileName),size:16,imageFileType:"png"})),n.a.createElement("label",null,t.fileName,"(",e.convertBitsToKb(t.fileSize),e.getFileSizeExtension(t.fileSize),")"),n.a.createElement("button",{"file-name":t.fileName,id:"closeBtnId_"+a,onClick:e.handleCloseClick.bind(e),onKeyDown:e.onCloseKeyDown.bind(e),tabIndex:0,title:"Close"},"   ",n.a.createElement("i",{className:"ms-Icon ms-Icon--Clear","aria-hidden":"true"})))}))),n.a.createElement(Xe.a,{fileTypes:[".docx",".doc",".pdf",".csv",".ppt",".xls",".xlsx",".txt"],multipleFiles:!0,handleFiles:this.handleFiles.bind(this),base64:!0},n.a.createElement(Je.a,{className:y.a.browseUi,title:"Browse","aria-label":"Browse","data-automation-id":"Browse",id:"browseBtnId",iconProps:{iconName:"CloudUpload"},tabIndex:0,onKeyDown:this.onBrowseKeyDown.bind(this)},"Attach relevant files to support your feedback"))),e.state.IsErrMgsVisible?n.a.createElement("span",{style:{color:"red",fontSize:"12px"}},e.AttachmentErrorMgs):e.state.IsErrFileSize?n.a.createElement("span",{style:{color:"red",fontSize:"12px"}},"Please select a file less than ",e.validationFileSize,"mb!"):void 0)}},{key:"onCloseKeyDown",value:function(e){try{var t=e.currentTarget.id;"Enter"===e.key&&m.AppInsightsTrackEvent(this.CUSTOMEVENTNAME,"Information","onCloseKeyDown","AttachmentSection",t)}catch(a){m.AppInsightsTrackEvent(this.CUSTOMEVENTNAME,"Error","onCloseKeyDown()","Error in onCloseKeyDown  | Attachment.tsx | "+a,"")}}},{key:"onBrowseKeyDown",value:function(e){try{var t=e.currentTarget.id;"Enter"===e.key&&m.AppInsightsTrackEvent(this.CUSTOMEVENTNAME,"Information","onBrowseKeyDown","AttachmentSection",t)}catch(a){m.AppInsightsTrackEvent(this.CUSTOMEVENTNAME,"Error","onBrowseKeyDown()","Error in onBrowseKeyDown  | Attachment.tsx | "+a,"")}}},{key:"saveInCache",value:function(e,t,a){try{var i,n={value:JSON.stringify(t),timestamp:(new Date).getTime()+this.cacheExpirationTimeStamp},s=this.webapi.getEnvironment(window.location.href);i=s.length>0&&""!==s?e+s+a:e+a,localStorage.setItem(i,JSON.stringify(n))}catch(r){m.AppInsightsTrackEvent(this.CUSTOMEVENTNAME,"Error","saveInCache()","Error in saveInCache"+this.fileName+r,"")}}},{key:"fetchCache",value:function(e,t){try{var a,i=this.webapi.getEnvironment(window.location.href);a=i.length>0&&""!==i?e+i+t:e+t;var n=localStorage.getItem(a),s=null!=n&&JSON.parse(n);return!!s&&((new Date).getTime()<s.timestamp&&JSON.parse(s.value))}catch(r){m.AppInsightsTrackEvent(this.CUSTOMEVENTNAME,"Error","fetchCache()","Error in saveInCache"+this.fileName+r,"")}}}]),a}(n.a.Component);function Ze(e){var t=n.a.useRef(null),a=n.a.useState(!1),s=Object(j.a)(a,2),r=s[0],o=s[1],c=e.options.some((function(e){return!0===e.isSelected})),l=e.options.filter((function(e){return!0===e.isSelected}))[0],p=c?l.title:"";Object(i.useEffect)((function(){return document.addEventListener("click",d,!1),function(){document.removeEventListener("click",d,!1)}}),[]);var d=function(e){t.current&&!t.current.contains(e.target)&&o(!1)};return n.a.createElement("div",{id:"IpFeedback-"+e.dropDownLabel.replace(/ /g,"")+"-DropDown"},n.a.createElement("section",null,n.a.createElement("label",null,e.dropDownLabel),e.isRequired&&n.a.createElement("span",{className:y.a.errorMandatory},"*")),n.a.createElement("section",{tabIndex:0,className:y.a.customDropdown,title:c?p:e.placeHolder,onClick:function(){return o(!r)},ref:t},n.a.createElement("span",null,c?p:e.placeHolder),n.a.createElement("i",{className:"ms-Icon ms-Icon--ChevronDown","aria-hidden":"true"}),r&&n.a.createElement("ul",null,e.options.map((function(t,a){return n.a.createElement("li",{tabIndex:0,id:"IpFeedback-"+e.dropDownLabel+"-DropDown-Options-"+t.name,key:t.name+"_"+a,title:t.title,onClick:function(){return e.dropDownOnClickEvent(e.dropDownLabel,t.name)},className:t.isSelected?"active":""},n.a.createElement("span",null," ",t.isSelected&&n.a.createElement(V.a,{iconName:t.iconName}))," ",t.title)})))))}var Ye=a(115),Qe=a.n(Ye),et=a(116),tt=function e(){Object(p.a)(this,e),this.Title=void 0,this.ReproSteps=void 0,this.SystemInfo=void 0,this.ProjectSiteURL=void 0,this.IPKitorOfferTitle=void 0,this.IPKitorOfferUrl=void 0,this.TagName=void 0,this.Source=void 0,this.FeedbackType=void 0,this.Impact=void 0,this.Title="",this.ReproSteps="",this.SystemInfo="",this.ProjectSiteURL="",this.IPKitorOfferTitle="",this.IPKitorOfferUrl="",this.TagName="",this.Source="",this.FeedbackType="",this.Impact=""},at=function(){function e(){Object(p.a)(this,e),this.CUSTOMEVENTNAME="Campus.CreateADOBug",this.webapi=new N,this.workItemIds="workItemIds",this.stroageObj=new Z,this.successMgs="success !! Ado work item Details have been inserted into DB."}return Object(d.a)(e,[{key:"AddWorkitem",value:function(){var e=Object(g.a)(b.a.mark((function e(t,a,i,n,s,r,o,c){var l,p,d,u,f,g,k=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l="","_apis/wit/workitems/$Bug?api-version=5.1",p="seeteam"===a.Source?a.ProjectSiteURL:"",d="seeteam"===a.Source?i.ADOProjectName+"\\"+n:s?i.ADOProjectName+"\\IPKit\\"+n:i.ADOProjectName+"\\Offer\\"+n,""===t?u=[{op:"add",path:"/fields/System.Title",value:a.Title},{op:"add",path:"/fields/System.Tags",value:"seeteam"===a.Source?"":a.TagName},{op:"add",path:"/fields/Microsoft.VSTS.TCM.ReproSteps",value:a.ReproSteps},{op:"add",path:"/fields/System.AreaPath",value:d},{op:"add",path:"/fields/Microsoft.VSTS.TCM.SystemInfo",value:a.SystemInfo},{op:"add",path:"/fields/Microsoft.VSTS.Common.Priority",from:null,value:"3"},{op:"add",path:"/fields/"+i.ADOCustomURLfield,value:p},{op:"add",path:"/fields/"+i.ADOCustomTitleField,value:a.IPKitorOfferTitle}]:(u=[{op:"add",path:"/fields/System.Title",value:a.Title},{op:"add",path:"/fields/System.Tags",value:"seeteam"===a.Source?"":a.TagName},{op:"add",path:"/fields/Microsoft.VSTS.TCM.ReproSteps",value:a.ReproSteps},{op:"add",path:"/fields/System.AreaPath",value:d},{op:"add",path:"/fields/Microsoft.VSTS.TCM.SystemInfo",value:a.SystemInfo},{op:"add",path:"/fields/Microsoft.VSTS.Common.Priority",from:null,value:"3"},{op:"add",path:"/fields/"+i.ADOCustomURLfield,value:p},{op:"add",path:"/fields/"+i.ADOCustomTitleField,value:a.IPKitorOfferTitle}],t.map((function(e,t){u.push({op:"add",path:"/relations/ -",value:{rel:"AttachedFile",url:e,attributes:{comment:"Any comment for the attachment",name:o&&o.length>t?o[t]:""}}})}))),f={Accept:"application/json-patch+json","Content-type":"application/json-patch+json"},e.next=9,this.webapi.PostCampusADO(i.ADOOrgName+"/"+i.ADOProjectName,"_apis/wit/workitems/$Bug?api-version=5.1",JSON.stringify(u),f).then((function(e){if(!0!==(!!e.hasOwnProperty("message")&&!(!e.message.includes("not authorized to access this resource")&&!e.message.includes("The current user does not have permission")))){var n=k.stroageObj.GetSessionStorage(k.workItemIds);if(null!==n){var s=JSON.parse(n);s.filter((function(e){return e.AdoId===i.ADOID}))[0].IDs.push(e.id),k.stroageObj.DeleteSessionStorage(k.workItemIds),k.stroageObj.SetSessionStorage(k.workItemIds,JSON.stringify(s))}l=e.url;var o={AdoId:i.ADOID,AdoWorkitemId:e.id,CreatedBy:M(),CreatedByDisplayName:F(),CreatedDate:new Date(e.fields["System.CreatedDate"]),ProjectSitePath:"seeteam"===a.Source?a.ProjectSiteURL:"",IPKitorOffer:a.IPKitorOfferTitle,IsGapFeedBack:!1,GapMitigateWid:0,Source:a.Source,IPKit:a.Source.toUpperCase()===$.PageType.internalIpkit.toUpperCase()||a.Source.toUpperCase()===$.PageType.ipforumIpkit.toUpperCase()?a.IPKitorOfferUrl:"",OfferId:a.Source.toUpperCase()===$.PageType.ipforumOffer.toUpperCase()?r:0,Tags:a.TagName,FeedbackTitle:c.feedbackTitle,FeedbackDescription:c.feedbackDescription,FeedbackType:c.feedbackType,Impact:c.impact,IsFileAttached:""!==t,ManageIpFeedbackAssignmentId:c.manageIpFeedbackAssignmentId,IsDomainFeedback:!1},p={Email:M()+"@microsoft.com",AdoPath:l.replace("apis/wit/workItems","workitems/edit"),FdTitle:a.Title,FdDescription:a.ReproSteps.split("<br><br>")[1],Domain:i.DomainName,IpkitOrOfferName:a.IPKitorOfferTitle,AdoItemId:e.id,SiteUrl:a.ProjectSiteURL,IpkitOrOfferUrl:a.IPKitorOfferUrl,EmailEnvironment:k.webapi.getEnvironment(),IsEngagementIPSurvey:""},d={FeedbackType:a.Source,ManageIPFeedbackFormDetails:o,IpFeedbackEmail:p};return m.AppInsightsTrackEvent(ft,"Information","API Success:created work item with attachment",l,""),k.webapi.PostCampusWebAPI(h.Campus,"EngagementIPSurvey/PostIpFeedbackWorkItemDetails",JSON.stringify(d)).then((function(e){m.AppInsightsTrackEvent(k.CUSTOMEVENTNAME,"Information","Successfully Ado Details Inserted into Ado work item table in DB",e.toString(),"")})).catch((function(e){m.AppInsightsTrackException(k.CUSTOMEVENTNAME,"Exception occured at Insert Ado work item Details in DB AddWorkitem()",e)})),k.successMgs}return m.AppInsightsTrackEvent(k.CUSTOMEVENTNAME,"Error","You are not authorized to access this ADO resource","Input Feedback Details"+JSON.stringify(a),""),"you are not authorized to access this ADO resource"})).catch((function(e){return m.AppInsightsTrackException(k.CUSTOMEVENTNAME,"Exception occured at Creating work item. AddWorkitem() ",e),"Error !! occured at Creating work item."}));case 9:return g=e.sent,e.abrupt("return",g);case 13:return e.prev=13,e.t0=e.catch(0),m.AppInsightsTrackException(this.CUSTOMEVENTNAME,"Exception occured at Creating work item. AddWorkitem() ",e.t0),e.abrupt("return","Error !! occured at Creating work item.");case 17:case"end":return e.stop()}}),e,this,[[0,13]])})));return function(t,a,i,n,s,r,o,c){return e.apply(this,arguments)}}()},{key:"AddWorkitemForGap",value:function(){var e=Object(g.a)(b.a.mark((function e(t,a,i,n,s,r,o){var c,l,p,d,u,f=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c="","Gap",l=o.toUpperCase()===$.FeedBackType.ipGap.toUpperCase()?"SEE IP Gaps":"Domain Feedback","_apis/wit/workitems/$Bug?api-version=5.1",""===t?p=[{op:"add",path:"/fields/System.Title",value:a.Title},{op:"add",path:"/fields/Microsoft.VSTS.TCM.ReproSteps",value:a.ReproSteps},{op:"add",path:"/fields/System.AreaPath",value:i.ADOProjectName+"\\"+n},{op:"add",path:"/fields/Microsoft.VSTS.TCM.SystemInfo",value:a.SystemInfo},{op:"add",path:"/fields/Microsoft.VSTS.Common.Priority",from:null,value:"3"},{op:"add",path:"/fields/"+i.ADOCustomURLfield,value:a.ProjectSiteURL},{op:"add",path:"/fields/System.Tags",value:l}]:(p=[{op:"add",path:"/fields/System.Title",value:a.Title},{op:"add",path:"/fields/Microsoft.VSTS.TCM.ReproSteps",value:a.ReproSteps},{op:"add",path:"/fields/System.AreaPath",value:i.ADOProjectName+"\\"+n},{op:"add",path:"/fields/Microsoft.VSTS.TCM.SystemInfo",value:a.SystemInfo},{op:"add",path:"/fields/Microsoft.VSTS.Common.Priority",from:null,value:"3"},{op:"add",path:"/fields/"+i.ADOCustomURLfield,value:a.ProjectSiteURL},{op:"add",path:"/fields/System.Tags",value:l}],t.map((function(e,t){p.push({op:"add",path:"/relations/ -",value:{rel:"AttachedFile",url:e,attributes:{comment:"Any comment for the attachment",name:s&&s.length>t?s[t]:""}}})}))),d={Accept:"application/json-patch+json","Content-type":"application/json-patch+json"},e.next=9,this.webapi.PostCampusADO(i.ADOOrgName+"/"+i.ADOProjectName,"_apis/wit/workitems/$Bug?api-version=5.1",JSON.stringify(p),d).then((function(e){if(!0!==(!!e.hasOwnProperty("message")&&!(!e.message.includes("not authorized to access this resource")&&!e.message.includes("The current user does not have permission")))){var n=f.stroageObj.GetSessionStorage(f.workItemIds);if(null!==n){var s=JSON.parse(n);s.filter((function(e){return e.AdoId===i.ADOID}))[0].IDs.push(e.id),f.stroageObj.DeleteSessionStorage(f.workItemIds),f.stroageObj.SetSessionStorage(f.workItemIds,JSON.stringify(s))}c=e.url;var p={AdoId:i.ADOID,AdoWorkitemId:e.id,CreatedBy:M(),CreatedByDisplayName:F(),CreatedDate:new Date(e.fields["System.CreatedDate"]),ProjectSitePath:a.ProjectSiteURL,IPKitorOffer:""!==a.IPKitorOfferTitle?a.IPKitorOfferTitle:" ",IsGapFeedBack:!0,GapMitigateWid:0,Source:"",IPKit:"",OfferId:null,Tags:l,FeedbackTitle:r.feedbackTitle,FeedbackDescription:r.feedbackDescription,FeedbackType:r.feedbackType,Impact:r.impact,IsFileAttached:""!==t,ManageIpFeedbackAssignmentId:r.manageIpFeedbackAssignmentId,IsDomainFeedback:o.toUpperCase()!==$.FeedBackType.ipGap.toUpperCase()},d={Email:M()+"@microsoft.com",AdoPath:c.replace("apis/wit/workItems","workitems/edit"),FdTitle:a.Title,FdDescription:a.ReproSteps.split("<br><br>")[1],Domain:i.DomainName,IpkitOrOfferName:""!==a.IPKitorOfferTitle?a.IPKitorOfferTitle:"Gap",AdoItemId:e.id.toString(),SiteUrl:a.ProjectSiteURL,IpkitOrOfferUrl:"",EmailEnvironment:f.webapi.getEnvironment(),IsEngagementIPSurvey:o.toUpperCase()===$.FeedBackType.ipGap.toUpperCase()?$.FeedBackType.ipGap:$.FeedBackType.domain},u={FeedbackType:o,ManageIPFeedbackFormDetails:p,IpFeedbackEmail:d};return m.AppInsightsTrackEvent(ft,"Information","API Success:created work item with attachment",c,""),f.webapi.PostCampusWebAPI(h.Campus,"EngagementIPSurvey/PostIpFeedbackWorkItemDetails",JSON.stringify(u)).then((function(e){m.AppInsightsTrackEvent(f.CUSTOMEVENTNAME,"Information","Successfully Ado Details Inserted into Ado work item table in DB",e.toString(),"")})).catch((function(e){m.AppInsightsTrackException(f.CUSTOMEVENTNAME,"Exception occured at Insert Ado work item Details in DB AddWorkitemForGap()",e)})),f.successMgs}return m.AppInsightsTrackEvent(f.CUSTOMEVENTNAME,"Error","You are not authorized to access this ADO resource","Input Feedback Details"+JSON.stringify(a),""),"you are not authorized to access this ADO resource"})).catch((function(e){return m.AppInsightsTrackException(f.CUSTOMEVENTNAME,"Exception occured at Creating work item. AddWorkitemForGap()",e),"Error !! occured at Creating work item."}));case 9:return u=e.sent,e.abrupt("return",u);case 13:return e.prev=13,e.t0=e.catch(0),m.AppInsightsTrackException(this.CUSTOMEVENTNAME,"Exception occured at Creating work item. AddWorkitemForGap() ",e.t0),e.abrupt("return","Error !! occured at Creating work item.");case 17:case"end":return e.stop()}}),e,this,[[0,13]])})));return function(t,a,i,n,s,r,o){return e.apply(this,arguments)}}()}]),e}(),it=function e(){Object(p.a)(this,e),this.ADOCustomTitleField=void 0,this.ADOCustomURLfield=void 0,this.ADOID=void 0,this.ADOOrgName=void 0,this.ADOProjectName=void 0,this.DomainName=void 0,this.ADOCustomTitleField="",this.ADOCustomURLfield="",this.ADOID=0,this.ADOOrgName="",this.ADOProjectName="",this.DomainName=""},nt=function(){function e(){Object(p.a)(this,e),this.CUSTOMEVENTNAME="Campus.CreateAttachment",this.webapi=new N,this.Workitem=new at,this.ADOdetails=new it,this.Errormsg="Uh-oh, you do not have access for ADO Instance",this.catchErrorMessage="OOPs! Something went wrong. Please try again a bit later.",this.successMgs="success !! Ado work item Details have been inserted into DB."}return Object(d.a)(e,[{key:"ProcessingFile",value:function(){var e=Object(g.a)(b.a.mark((function e(t,a,i,n,s,r){var o,c,l,p,d,u,f=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=i?"true":"false","",c=n.toString(),l=a.Source.toUpperCase()===$.PageType.ipforumOffer.toUpperCase()&&s===c?"https://servicesportfolio.net/Offer/Index?Title="+encodeURIComponent(a.IPKitorOfferTitle.trim())+"&OID="+s:s,"IPForum",p="true"===o?(p=s.substring(s.lastIndexOf("/")+1)).includes(".")?p:a.IPKitorOfferTitle:(p=a.Source.toUpperCase()===$.PageType.ipforumOffer.toUpperCase()&&s===c?"OfferID"+n:a.Source.toUpperCase()===$.PageType.ipforumOffer.toUpperCase()?s:"OfferID"+s.substring(s.lastIndexOf("?k=CampusOfferingIDString")+28)).includes("/")?p.substring(s.lastIndexOf("/")+1):p,a.IPKitorOfferUrl=s,e.next=10,this.webapi.GetCampusWebAPI(h.Campus,"IPFeedbackADO/GetADOConfigs?Projectsiteurl="+a.ProjectSiteURL+"&IsIpkit="+o+"&IPKitorOfferID="+n).then(function(){var e=Object(g.a)(b.a.mark((function e(s){var o,c,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s.length>0)){e.next=15;break}if(s.map((function(e){f.ADOdetails.ADOCustomTitleField=e.ADOCustomTitleField,f.ADOdetails.ADOCustomURLfield=e.ADOCustomURLfield,f.ADOdetails.ADOID=e.ADOID,f.ADOdetails.ADOOrgName=e.ADOOrgName,f.ADOdetails.ADOProjectName="seeteam"===a.Source||"internalipkit"===a.Source?e.ADOProjectName:"IPForum",f.ADOdetails.DomainName=e.DomainName,d=e.FeedbackAreaPath,a.SystemInfo="seeteam"===a.Source?a.SystemInfo+'<br><br>IPKit/Offer: <a href="'+l+'">'+p+'</a><br><br>ProjectSiteURL: <a href="'+a.ProjectSiteURL+'">'+e.ProjectSiteName+"</a>":a.SystemInfo+'<br><br>IPKit/Offer: <a href="'+l+'">'+p+"</a>"})),o=t,!(Object.keys(o).length>0)){e.next=11;break}return c=[],u=Object.keys(o).map(function(){var e=Object(g.a)(b.a.mark((function e(t){var a,i,n,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.push(o[t].fileName),a="_apis/wit/attachments?fileName="+encodeURIComponent(o[t].fileName)+"&uploadType=Simple&api-version=5.1",i=o[t].base64Str,n={"Content-type":"application/octet-stream"},e.next=6,f.webapi.PostCampusADO(f.ADOdetails.ADOOrgName+"/"+f.ADOdetails.ADOProjectName,a,i,n).then(function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===(!!t.hasOwnProperty("message")&&!!t.message.includes("not authorized to access this resource"))){e.next=8;break}return console.log("success attached"),m.AppInsightsTrackEvent(f.CUSTOMEVENTNAME,"Information","API Success:Created attachemnt",t.url,""),console.log(t.url),e.abrupt("return",t.url);case 8:return f.Errormsg,e.abrupt("return",null);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){console.log("error creating attachment"),m.AppInsightsTrackException(f.CUSTOMEVENTNAME,"Exception occured at creating attachment",e),console.error(e)}));case 6:return s=e.sent,e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=8,Promise.all(u).then(function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f.Workitem.AddWorkitem(t,a,f.ADOdetails,d,i,n,c,r),m.AppInsightsTrackEvent(f.CUSTOMEVENTNAME,"Information","API Success:Work Item Createds","success","");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:return e.abrupt("return",f.successMgs);case 11:return f.Workitem.AddWorkitem("",a,f.ADOdetails,d,i,n,[],r),e.abrupt("return",f.successMgs);case 13:e.next=17;break;case 15:return m.AppInsightsTrackEvent(ft,"Error","No ADO Configuration found","Error !! : Sorry No ADO Configuration found for Submitting Feedback",""),e.abrupt("return","Error !! : Sorry No ADO Configuration found for Submitting Feedback");case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return m.AppInsightsTrackException(ft,"Exception occured at getting Ado Details",e),"Error !! occured at getting Ado Details"}));case 10:return u=e.sent,e.abrupt("return",u);case 14:return e.prev=14,e.t0=e.catch(0),m.AppInsightsTrackException("Campus.IPFeedback","Exception occured at ProcessingFile(). ",e.t0),e.abrupt("return",this.catchErrorMessage);case 18:case"end":return e.stop()}}),e,this,[[0,14]])})));return function(t,a,i,n,s,r){return e.apply(this,arguments)}}()},{key:"ProcessingFileForGap",value:function(){var e=Object(g.a)(b.a.mark((function e(t,a,i,n){var s,r,o=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,"",e.next=4,this.webapi.GetCampusWebAPI(h.Campus,"IPFeedbackADO/GetAdoConfigsforSurvey?Projectsiteurl="+a.ProjectSiteURL).then(function(){var e=Object(g.a)(b.a.mark((function e(r){var c,l,p;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>0)){e.next=15;break}if(r.map((function(e){o.ADOdetails.ADOCustomTitleField=e.ADOCustomTitleField,o.ADOdetails.ADOCustomURLfield=e.ADOCustomURLfield,o.ADOdetails.ADOID=e.ADOID,o.ADOdetails.ADOOrgName=e.ADOOrgName,o.ADOdetails.ADOProjectName=e.ADOProjectName,o.ADOdetails.DomainName=e.DomainName,s=e.FeedbackAreaPath,e.AlreadyExists,a.SystemInfo=a.SystemInfo+'<br><br>ProjectSiteURL: <a href="'+a.ProjectSiteURL+'">'+e.ProjectSiteName+"</a><br><br>"})),c=t,!(Object.keys(c).length>0)){e.next=11;break}return l=[],p=Object.keys(c).map(function(){var e=Object(g.a)(b.a.mark((function e(t){var a,i,n,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.push(c[t].fileName),a="_apis/wit/attachments?fileName="+encodeURIComponent(c[t].fileName)+"&uploadType=Simple&api-version=5.1",i=c[t].base64Str,n={"Content-type":"application/octet-stream"},e.next=6,o.webapi.PostCampusADO(o.ADOdetails.ADOOrgName+"/"+o.ADOdetails.ADOProjectName,a,i,n).then(function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0===(!!t.hasOwnProperty("message")&&!!t.message.includes("not authorized to access this resource"))){e.next=6;break}return m.AppInsightsTrackEvent(ft,"Information","API Success:Created attachemnt",t.url,""),e.abrupt("return",t.url);case 6:return o.Errormsg,e.abrupt("return",null);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){m.AppInsightsTrackException(ft,"Exception occured at creating attachment for EngagementIPSurvey",e)}));case 6:return s=e.sent,e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=8,Promise.all(p).then(function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.Workitem.AddWorkitemForGap(t,a,o.ADOdetails,s,l,n,i),m.AppInsightsTrackEvent(ft,"Information","API Success:Work Item Createds","success","");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:return e.abrupt("return",o.successMgs);case 11:return o.Workitem.AddWorkitemForGap("",a,o.ADOdetails,s,[],n,i),e.abrupt("return",o.successMgs);case 13:e.next=17;break;case 15:return m.AppInsightsTrackEvent(ft,"Error","No ADO Configuration found","Error !! : Sorry No ADO Configuration found for Submitting Feedback",""),e.abrupt("return","Error !! : Sorry No ADO Configuration found for Submitting Feedback");case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return m.AppInsightsTrackException(ft,"Exception occured at getting Ado Details",e),"Error !! occured at getting Ado Details"}));case 4:return r=e.sent,e.abrupt("return",r);case 8:return e.prev=8,e.t0=e.catch(0),m.AppInsightsTrackException(ft,"Exception occured at ProcessingFile(). ",e.t0),e.abrupt("return",this.catchErrorMessage);case 12:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t,a,i,n){return e.apply(this,arguments)}}()}]),e}(),st={root:[{selectors:{".ms-Panel-main":{backgroundColor:"#fafafa"}}}]},rt={root:[{selectors:{".ms-TextField-fieldGroup":{border:"0",":hover":{borderBottom:"1px solid #000000"},":focus":{borderBottom:"1px solid #2a76d4",borderTop:"0",borderRight:"0",borderLeft:"0",outLine:"none"}}}}]},ot=[{name:"Defect",title:"Bug/Defect",isSelected:!1,iconName:"CheckMark"},{name:"Modification",title:"Addition/Modification",isSelected:!1,iconName:"CheckMark"},{name:"IPGap",title:"IP Gap",isSelected:!1,iconName:"CheckMark"},{name:"NewIdea",title:"New Idea",isSelected:!1,iconName:"CheckMark"}],ct=[{name:"ReducedDeliveryTime",title:"Reduced Delivery Time",isSelected:!1,iconName:"CheckMark"},{name:"InfluencedConsumption",title:"Influenced Consumption",isSelected:!1,iconName:"CheckMark"},{name:"NewDeliveryCapability",title:"New Delivery Capability",isSelected:!1,iconName:"CheckMark"},{name:"IncreasedProductivity",title:"Increased Productivity",isSelected:!1,iconName:"CheckMark"},{name:"GeneralFeedback",title:"General Feedback",isSelected:!1,iconName:"CheckMark"}],lt={root:[{selectors:{".ms-Spinner-label":{fontSize:"16px"}}}]},pt=function(e){Object(I.a)(a,e);var t=Object(v.a)(a);function a(e){var i;return Object(p.a)(this,a),(i=t.call(this,e)).selectedFeedbackType="",i.selectedImpact="",i.fileName="GetFeedbackForm.tsx",i.TitleErrorMessage="Title is required. Please fill the value.",i.TitleMaxCharErrorMsg="Title should not exist more than 250 characters.",i.feedBackErrorMgs="Feedback Type is required. Please fill the value.",i.impactErrorMgs="Impact is required. Please fill the value.",i.descriptionErrorMgs="Minimum of 50 characters required.",i.CreateAttachment=new nt,i.ErrorMesaage="Failure: Sorry No ADO Configuration found for Submitting Feedback",i.IpkitOfferErrorMsg="No Offers or IPKits were selected.",i.catchErrorMessage="OOPs! Something went wrong. Please try again a bit later.",i.successText="success",i.failedText="failed",i.cancelText="cancel",i.editorConfig={toolbar:{items:["bold","italic","underline","strikethrough","|","highlight:yellowMarker","fontColor","fontSize","heading","|","link","bulletedList","numberedList","|","indent","outdent","|","blockQuote","code","subscript","superscript","undo","redo"]},placeholder:"Describe your feedback in detail and include any relevant links. A minimum of 50 characters is required."},i.selectText="Select",i.onDismissMessageBar=function(){try{i.setState({IPErrorVisible:!1}),m.AppInsightsTrackEvent(ft,"Information","MessageBar","IP Feedback MessageBar Dismiss button clicked","IpFeedback-MessageBar")}catch(e){m.AppInsightsTrackException(ft,"Exception occured at method onDismissMessageBar()",e)}},i.GetIPKitWorkItemDetails=function(e){var t=new tt;return t.Title="IPKitFeedbackBug: "+i.state.Title.substring(0,25)+"_SubmittedBy "+M(),t.ReproSteps=i.state.Title+"<br><br>"+i.state.Description,t.SystemInfo="IPKit Title: "+i.props.IPObject.IPTitle+"<br><br>Submitted By: "+F()+" Email : "+U(),t.ProjectSiteURL=i.props.SiteUrl,t.IPKitorOfferTitle=i.props.IPObject.IPTitle,t.TagName="SEE IPKit",t.Source=e,t.FeedbackType=i.selectedFeedbackType,t.Impact=i.selectedImpact,t},i.GetOfferWorkItemDetails=function(e){var t=new tt;return t.Title="IPFFeedbackBug: "+i.state.Title.substring(0,25)+"_SubmittedBy "+M(),t.ReproSteps=i.state.Title+"<br><br>"+i.state.Description,t.SystemInfo="IPKit/Offer Title: "+i.props.IPObject.IPTitle+"<br><br>Submitted By: "+F()+" Email : "+U(),t.ProjectSiteURL=i.props.SiteUrl,t.IPKitorOfferTitle=i.props.IPObject.IPTitle,t.TagName="ipforumipkit"===e?"IPForum IPKit":"IPForum Offer",t.Source=e,t.FeedbackType=i.selectedFeedbackType,t.Impact=i.selectedImpact,t},i.GetSeeTeamWorkItemDetails=function(){var e=new tt;return e.Title="SEEBug: "+i.state.Title.substring(0,25)+"_SubmittedBy "+M(),e.ReproSteps=i.state.Title+"<br><br>"+i.state.Description,e.SystemInfo="IPKit Title: "+i.props.IPObject.IPTitle+"<br><br>Submitted By: "+F()+" Email : "+U(),e.ProjectSiteURL=i.props.SiteUrl,e.IPKitorOfferTitle=i.props.IPObject.IPTitle,e.TagName="seeteam",e.Source="seeteam",e.FeedbackType=i.selectedFeedbackType,e.Impact=i.selectedImpact,e},i.GetIPGapWorkItemDetails=function(){var e=new tt;return e.Title="SEEBug: "+i.state.Title.substring(0,25)+"_SubmittedBy "+M(),e.ReproSteps=i.state.Title+"<br><br>"+i.state.Description,e.SystemInfo="Submitted By: "+F()+" Email : "+M()+"@microsoft.com",e.ProjectSiteURL=i.props.SiteUrl,e.FeedbackType=i.selectedFeedbackType,e.Impact=i.selectedImpact,e},i.GetDomainWorkItemDetails=function(){var e=new tt;return e.Title="SEEBug: "+i.state.Title.substring(0,25)+"_SubmittedBy "+M(),e.ReproSteps=i.state.Title+"<br><br>"+i.state.Description,e.SystemInfo="Domain Title: "+i.props.OfferOrIpkitName+"<br><br>Submitted By: "+F()+" Email : "+U(),e.ProjectSiteURL=i.props.SiteUrl,e.IPKitorOfferTitle=i.props.OfferOrIpkitName,e.TagName="seeteam",e.Source="seeteam",e.FeedbackType=i.selectedFeedbackType,e.Impact=i.selectedImpact,e},i.GetFeedbackFormValidation=function(){try{var e=!0,t=i.state.TitleErrorVisible,a=i.state.TitleErrorMsg,n=i.state.FeedbackTypeErrorVisible,s=i.state.ImpactErrorVisible,r=i.state.DescErrorVisible,o=i.state.Description.replace(/(<([^>]+)>)/gi,"");return""===i.state.Title.trim()&&(e=!1,t=!0,a=i.TitleErrorMessage),""!==i.selectedImpact&&i.selectedImpact.toUpperCase()!==i.selectText.toUpperCase()||(s=!0),""!==i.selectedFeedbackType&&i.selectedFeedbackType.toUpperCase()!==i.selectText.toUpperCase()||(n=!0),(""===i.state.Description.trim()||o.length<50)&&(e=!1,r=!0),""===i.props.IPObject&&i.props.feedbackType.toUpperCase()!==$.FeedBackType.domain.toUpperCase()&&i.props.feedbackType.toUpperCase()!==$.FeedBackType.ipGap.toUpperCase()&&(e=!1,i.ErrorMesaage=i.IpkitOfferErrorMsg),i.setState({TitleErrorVisible:t,TitleErrorMsg:a,FeedbackTypeErrorVisible:n,ImpactErrorVisible:s,DescErrorVisible:r}),e}catch(c){m.AppInsightsTrackException(ft,"Exception occured at GetFeedbackFormValidation(). "+i.fileName,c)}},i.CkeditorValidation=function(e){try{e.replace(/(<([^>]+)>)/gi,"").length>50?i.setState({Description:e,DescErrorVisible:!1}):i.setState({Description:e,DescErrorVisible:!0})}catch(t){m.AppInsightsTrackException(ft,"Exception occured at CkeditorValidation(). "+i.fileName,t)}},i._TitleChange=function(e,t){try{if(void 0===t||t.length>250)return void i.setState({TitleErrorVisible:!0,TitleErrorMsg:i.TitleMaxCharErrorMsg});i.setState({Title:t,TitleErrorVisible:!1})}catch(a){m.AppInsightsTrackException(ft,"Exception occured at _TitleChange(). "+i.fileName,a)}},i._validateTitle=function(e){try{""===e.target.value.trim()?i.setState({TitleErrorVisible:!0,TitleErrorMsg:i.TitleErrorMessage}):i.setState({TitleErrorVisible:!1})}catch(t){m.AppInsightsTrackException(ft,"Exception occured at _validateTitle(). "+i.fileName,t)}},i._cancelClick=function(e){m.AppInsightsTrackEvent(ft,"Information","Get Feedback","Get Feedback Cancel button clicked",e.currentTarget.id),i.setState({Title:"",Description:"",Attachments:[],TitleErrorVisible:!1,DescErrorVisible:!1,FeedbackTypeErrorVisible:!1,ImpactErrorVisible:!1,IsPanelOpen:!1}),i.props.resetTree(i.cancelText,"")},i.state={Title:"",Description:"",Attachments:[],feedbackTypeOptions:ot,ImpactOptions:ct,IsPanelOpen:!0,IPErrorVisible:!1,IPErrorMessage:"",TitleErrorMsg:"",TitleErrorVisible:!1,DescErrorVisible:!1,FeedbackTypeErrorVisible:!1,ImpactErrorVisible:!1,showSpinner:!1},i.dismissPanel=i.dismissPanel.bind(Object(k.a)(i)),i}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.props.feedbackType.toUpperCase().indexOf($.FeedBackType.ipGap.toUpperCase())>=0,a=this.props.feedbackType.toUpperCase().indexOf($.FeedBackType.domain.toUpperCase())>=0?"Selected Domain":"Selected IP";return n.a.createElement(We.a,{styles:st,className:y.a.giveFeedbackPanel,isOpen:this.state.IsPanelOpen,onDismiss:this.dismissPanel,headerText:"Give Feedback",closeButtonAriaLabel:"Close",isFooterAtBottom:!0,type:ze.a.medium,customWidth:"888px"},n.a.createElement("div",null,!t&&n.a.createElement("section",{className:y.a.selectedField},n.a.createElement(He.a,{label:a,disabled:!0,defaultValue:this.props.OfferOrIpkitName})),n.a.createElement("section",{className:"".concat(y.a.feedbackFormContr," ")},n.a.createElement(He.a,{styles:rt,label:"Title",required:!0,placeholder:"Summarize your feedback",value:this.state.Title,onChange:this._TitleChange.bind(this),onBlur:this._validateTitle.bind(this),tabIndex:0}),this.state.TitleErrorVisible&&n.a.createElement("span",{style:{color:"red",fontSize:"12px"}},this.state.TitleErrorMsg)),n.a.createElement("section",{className:"".concat(y.a.feedbackFormContr," ")},n.a.createElement(Ze,{dropDownLabel:"Feedback Type",placeHolder:this.selectText,isRequired:!0,dropDownOnClickEvent:this.feedbackTypeDropDownOnClickEvent.bind(this),options:this.state.feedbackTypeOptions}),this.state.FeedbackTypeErrorVisible&&n.a.createElement("span",{style:{color:"red",fontSize:"12px"}},this.feedBackErrorMgs)),n.a.createElement("section",{className:"".concat(y.a.feedbackFormContr," ")},n.a.createElement(Ze,{dropDownLabel:"Impact",placeHolder:this.selectText,isRequired:!0,dropDownOnClickEvent:this.impactDropDownOnClickEvent.bind(this),options:this.state.ImpactOptions}),this.state.ImpactErrorVisible&&n.a.createElement("span",{style:{color:"red",fontSize:"12px"}},this.impactErrorMgs)),n.a.createElement("section",{className:"".concat(y.a.feedbackFormContr," ").concat(y.a.emailDescription)},n.a.createElement("label",null,"Description",n.a.createElement("span",{className:y.a.errorMandatory},"*")),n.a.createElement(et.CKEditor,{className:"test",editor:Qe.a,activeClass:"p10",data:this.state.Description,config:this.editorConfig,onChange:function(t,a){var i=a.getData();e.setState({Description:i})},onBlur:function(t,a){var i=a.getData();e.CkeditorValidation(i)},onInit:function(e){e.ui.getEditableElement().parentElement.insertBefore(e.ui.view.toolbar.element,e.ui.getEditableElement())}}),this.state.DescErrorVisible&&n.a.createElement("span",{style:{color:"red",fontSize:"12px"}},this.descriptionErrorMgs)),n.a.createElement("section",{className:"".concat(y.a.feedbackFormContr," ").concat(y.a.formFields)},n.a.createElement($e,{Attachments:this.AttachmentValueUpdateHandler.bind(this),fromParentToChild:this.state.Attachments}))),n.a.createElement("div",{className:y.a.giveFeedbackPanelBtn},n.a.createElement(Ce.a,{onClick:this._saveClick.bind(this),id:"IpFeedback-GetFeedback-Submit-Btn"},"Submit"),n.a.createElement(Ae.a,{onClick:this._cancelClick.bind(this),id:"IpFeedback-GetFeedback-Cancel-Btn"},"Cancel")),this.state.IPErrorVisible&&n.a.createElement(ae.a,{className:y.a.nofeedbacksmsg,messageBarType:te.a.error,onDismiss:this.onDismissMessageBar.bind(this),id:"IpFeedback-GetFeedback-MessageBar",dismissButtonAriaLabel:"close"},this.state.IPErrorMessage),this.state.showSpinner&&n.a.createElement("div",{className:y.a.pageCenterSpinner}," ",n.a.createElement(pe.a,{styles:lt,label:"Processing...",ariaLive:"assertive",labelPosition:"right"})))}},{key:"_saveClick",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t,a,i,n=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,m.AppInsightsTrackEvent(ft,"Information","Existing IP Feedback","Existing IP Feedback Submit button clicked","ExistingIPFeedback_SubmitButton"),this.GetFeedbackFormValidation()){e.next=5;break}return e.abrupt("return");case 5:if(this.setState({IPErrorVisible:!1,showSpinner:!0}),t=this.props.SourceName.toUpperCase()===$.PageType.internalIpkit.toUpperCase()?this.GetIPKitWorkItemDetails(this.props.SourceName.toLocaleLowerCase()):this.props.SourceName.toUpperCase()===$.PageType.ipforumIpkit.toUpperCase()||this.props.SourceName.toUpperCase()===$.PageType.ipforumOffer.toUpperCase()?this.GetOfferWorkItemDetails(this.props.SourceName):this.props.feedbackType.toUpperCase()===$.FeedBackType.ipGap.toUpperCase()?this.GetIPGapWorkItemDetails():this.props.feedbackType.toUpperCase()===$.FeedBackType.domain.toUpperCase()?this.GetDomainWorkItemDetails():this.GetSeeTeamWorkItemDetails(),a={feedbackTitle:this.state.Title,feedbackDescription:this.state.Description,feedbackType:this.selectedFeedbackType,impact:this.selectedImpact,isFileAttached:this.state.Attachments.length>0,isGapFeedback:this.props.feedbackType.toUpperCase()===$.FeedBackType.ipGap.toUpperCase(),ipName:this.props.OfferOrIpkitName,manageIpFeedbackAssignmentId:this.props.assignedFeedbackId},i=this.state.Attachments.length>0?this.state.Attachments:{},"",this.props.feedbackType.toUpperCase()!==$.FeedBackType.ipGap.toUpperCase()&&this.props.feedbackType.toUpperCase()!==$.FeedBackType.domain.toUpperCase()){e.next=15;break}return e.next=13,this.CreateAttachment.ProcessingFileForGap(i,t,this.props.feedbackType,a).then((function(e){e.toUpperCase().indexOf("ERROR")>-1||e.toUpperCase().indexOf("OOPS")>-1?n.setState({showSpinner:!1,IPErrorVisible:!0,IPErrorMessage:e}):(n.setState({Title:"",Description:"",Attachments:[],IPErrorVisible:!1,showSpinner:!1}),n.selectedFeedbackType="",n.selectedImpact="",n.props.resetTree(n.successText,n.props.feedbackType))})).catch((function(e){n.setState({showSpinner:!1,IPErrorVisible:!0,IPErrorMessage:n.catchErrorMessage}),m.AppInsightsTrackException(ft,"Exception occured at ProcessingFileForGap() method. "+n.fileName+"SiteUrl : "+n.props.SiteUrl+" IPName :"+n.props.OfferOrIpkitName,e)}));case 13:e.next=17;break;case 15:return e.next=17,this.CreateAttachment.ProcessingFile(i,t,this.props.IPObject.IPType,this.props.IPObject.IPID,this.props.IPObject.IPSource,a).then(function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.toUpperCase().indexOf("ERROR")>-1||t.toUpperCase().indexOf("OOPS")>-1?n.setState({showSpinner:!1,IPErrorVisible:!0,IPErrorMessage:t}):(n.setState({Title:"",Description:"",Attachments:[],IPErrorVisible:!1,showSpinner:!1}),n.selectedFeedbackType="",n.selectedImpact="",n.props.resetTree(n.successText,n.props.feedbackType));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){n.setState({showSpinner:!1,IPErrorVisible:!0,IPErrorMessage:n.catchErrorMessage}),m.AppInsightsTrackException(ft,"Exception occured at ProcessingFile() method. "+n.fileName+"SiteUrl : "+n.props.SiteUrl+" IPName :"+n.props.OfferOrIpkitName,e)}));case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),m.AppInsightsTrackException(ft,"Exception occured at dismissPanel(). "+this.fileName,e.t0);case 22:case"end":return e.stop()}}),e,this,[[0,19]])})));return function(){return e.apply(this,arguments)}}()},{key:"dismissPanel",value:function(){try{this.setState({IsPanelOpen:!this.state.IsPanelOpen,Title:"",Description:"",Attachments:[],TitleErrorVisible:!1,DescErrorVisible:!1,FeedbackTypeErrorVisible:!1,ImpactErrorVisible:!1}),this.props.resetTree(this.cancelText,"")}catch(e){m.AppInsightsTrackException(ft,"Exception occured at dismissPanel(). "+this.fileName,e)}}},{key:"AttachmentValueUpdateHandler",value:function(e){this.setState({Attachments:e})}},{key:"feedbackTypeDropDownOnClickEvent",value:function(e,t){try{var a=JSON.parse(JSON.stringify(this.state.feedbackTypeOptions));a.map((function(e){return e.isSelected=!1})),a.filter((function(e){return e.name.toUpperCase()===t.toUpperCase()}))[0].isSelected=!0,this.selectedFeedbackType=a.filter((function(e){return e.name.toUpperCase()===t.toUpperCase()}))[0].title,this.setState({feedbackTypeOptions:Object(K.a)(a),FeedbackTypeErrorVisible:!1}),m.AppInsightsTrackEvent(ft,"Information",e+" Dropdown","Selected Dropdown value is "+t+"on the IpFeedback Page","IpFeedback-"+e+"-DropDown")}catch(i){m.AppInsightsTrackException(ft,"Exception occured at feedbackTypeDropDownOnClickEvent(). "+this.fileName,i)}}},{key:"impactDropDownOnClickEvent",value:function(e,t){try{var a=JSON.parse(JSON.stringify(this.state.ImpactOptions));a.map((function(e){return e.isSelected=!1})),a.filter((function(e){return e.name.toUpperCase()===t.toUpperCase()}))[0].isSelected=!0,this.selectedImpact=a.filter((function(e){return e.name.toUpperCase()===t.toUpperCase()}))[0].title,this.setState({ImpactOptions:Object(K.a)(a),ImpactErrorVisible:!1}),m.AppInsightsTrackEvent(ft,"Information",e+" Dropdown","Selected Dropdown value is "+t+"on the IpFeedback Page","IpFeedback-"+e+"-DropDown")}catch(i){m.AppInsightsTrackException(ft,"Exception occured at impactDropDownOnClickEvent(). "+this.fileName,i)}}}]),a}(i.Component),dt=function e(){Object(p.a)(this,e),this.ManageIPFeedbackAssignmentId=void 0,this.ProjectSiteID=void 0,this.ProjectSite=void 0,this.IPFeedbackAssignedBy=void 0,this.IPFeedbackAssignedByName=void 0,this.IPFeedbackAssignedDate=void 0,this.IPFeedbackLeadArchitect=void 0,this.IPFeedbackLeadArchitectName=void 0,this.IPFeedbackBackUpArchitect=void 0,this.IPFeedbackBackUpArchitectName=void 0,this.IPFeedbackStatus=void 0},ut=a(226),mt=a(117),ht=function(){function e(){var t=this;Object(p.a)(this,e),this.app=void 0,this.applicationConfig=void 0,this.getTokenWithLoginPopup=function(e){var a=t.getAuthenticationParameters(e);return t.app.acquireTokenSilent(a).then((function(e){return e.accessToken})).catch((function(e){return console.log("Errot : ",e),t.getAccessToken(!1).then((function(e){return e}))}))};var a=window.location.href;this.applicationConfig={clientID:"e0f60ff0-327b-43e2-9055-54782bbed141",graphScopesForCampusWebAPI:["https://campuswebapi.azurewebsites.net/user_impersonation"],graphScopesForWikiAPI:["XXXXXXXXXXXXXX/AllSites.Read"],graphScopes:["AllSites.Read"]},this.app=new ut.a({auth:{clientId:this.applicationConfig.clientID,redirectUri:a,postLogoutRedirectUri:window.location.origin,authority:"https://login.microsoftonline.com/72f988bf-86f1-41af-91ab-2d7cd011db47/"},system:{loadFrameTimeout:1e4},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}})}return Object(d.a)(e,[{key:"getAuthenticationParameters",value:function(e){var t=this.app.getAccount(),a=null;return a="team"===e?this.applicationConfig.graphScopesForCampusWebAPI:"wiki"===e?this.applicationConfig.graphScopesForWikiAPI:this.applicationConfig.graphScopesForCampusWebAPI,t&&t.userName?{scopes:a,loginHint:t.userName,authority:"https://login.microsoftonline.com/72f988bf-86f1-41af-91ab-2d7cd011db47/"}:{scopes:a,authority:"https://login.microsoftonline.com/72f988bf-86f1-41af-91ab-2d7cd011db47/"}}},{key:"getAccessToken",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.length>0&&void 0!==t[0]&&t[0],e.abrupt("return",new Promise((function(e,t){mt.authentication.authenticate({url:window.location.origin+"/auth-start.html",width:600,height:535,successCallback:function(t){e(t)},failureCallback:function(e){t(e)}})})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),ft="IPFeedBack",bt=["Azure Cloud & Artificial Intelligence","Business Applications","Modern Workplace"],gt=function(e){Object(I.a)(a,e);var t=Object(v.a)(a);function a(e){var i;return Object(p.a)(this,a),(i=t.call(this,e)).loginUserEmail="v-maytiw@microsoft.com",i.loginUserAlias="v-maytiw",i.authService=new ht,i.isHeader=void 0,i.fileName="feedback.tsx",i.ipkit="",i.ipFeedbackArchitect=[],i.OfferOrIpkitName="",i.projectManagementChannelText="ProjectManagement",i.activeSurveyDetails="ActiveSurveyDetails",i.stroageObj=new Z,i.successText="success",i.failedText="failed",i.webapi=new N,i.submitEvent="submit",i.catchErrorMessage="OOPs! Something went wrong. Please try again a bit later.",i.siteName="",i.setProjectSiteIPSurveyDetails=function(e){try{if(i.state.isProjectManagementChannel){var t="The IP Feedback has been assigned to "+e.IPFeedbackLeadArchitectName+" and "+e.IPFeedbackBackUpArchitectName;i.setState({ipFeedbackSurveyStatus:fe.architectAssigned,showMessageBar:!0,messageBarType:te.a.success,messageBarMessage:t,tabSpinner:!1,assignedFeedbackId:e.IPFeedbackBackUpArchitect===i.loginUserEmail||e.IPFeedbackLeadArchitect===i.loginUserEmail?e.ManageIPFeedbackAssignmentId:0,activeSurveyDetail:e})}else i.setState({ipFeedbackSurveyStatus:fe.architectAssigned,tabSpinner:!1,assignedFeedbackId:e.IPFeedbackBackUpArchitect===i.loginUserEmail||e.IPFeedbackLeadArchitect===i.loginUserEmail?e.ManageIPFeedbackAssignmentId:0,activeSurveyDetail:e,showMessageBar:!1})}catch(a){m.AppInsightsTrackException(ft,"Exception occured at setProjectSiteIPSurveyDetails(). ",a)}},i.resetProjectSiteIPSurveyDetails=Object(g.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{null===i.stroageObj.GetSessionStorage(i.activeSurveyDetails+i.siteName)&&i.setState({ipFeedbackSurveyStatus:fe.invalid,tabSpinner:!1,assignedFeedbackId:0,activeSurveyDetail:new dt})}catch(t){m.AppInsightsTrackException(ft,"Exception occured at resetProjectSiteIPSurveyDetails(). ",t)}case 1:case"end":return e.stop()}}),e)}))),i.cancelAssignment=function(){var e=Object(g.a)(b.a.mark((function e(t,a){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t!==i.submitEvent){e.next=7;break}return i.setState({feedbackOnExistingIp:!0,allFeedback:!1,assignFeedback:!1,cancelFeedback:!1,showMessageBar:!0,manageTabActive:!1,messageBarMessage:"The IP Feedback request assigned to "+a.IPFeedbackLeadArchitectName+"/"+a.IPFeedbackBackUpArchitectName+" has been cancelled.",messageBarType:te.a.success,tabSpinner:!0}),e.next=5,i.resetProjectSiteIPSurveyDetails();case 5:e.next=8;break;case 7:i.setState({feedbackOnExistingIp:!0,allFeedback:!1,assignFeedback:!1,cancelFeedback:!1,manageTabActive:!1});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),m.AppInsightsTrackException(ft,"Exception occured at method cancelAssignment()",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a){return e.apply(this,arguments)}}(),i.onDismissMessageBar=function(){try{i.setState({showMessageBar:!1}),m.AppInsightsTrackEvent(ft,"Information","MessageBar","IP Feedback MessageBar Dismiss button clicked","IpFeedback-MessageBar")}catch(e){m.AppInsightsTrackException(ft,"Exception occured at method onDismissMessageBar()",e)}},i.resetActiveClass=function(e){try{i.setState({manageTabActive:!e})}catch(t){m.AppInsightsTrackException(ft,"Exception occured at method resetActiveClass()",t)}},i._setIPTitle=function(e){e.IPTitle.toString().toUpperCase().indexOf($.FeedBackType.ipGap.toUpperCase())>=0?(i.OfferOrIpkitName="",i.setState({IPObject:e.IPTitle,IPReset:!1,isPanelOpen:!0,feedbackType:$.FeedBackType.ipGap})):bt.toString().toUpperCase().indexOf(e.IPTitle.toUpperCase())>=0?(i.OfferOrIpkitName=e.IPTitle,i.setState({IPObject:e.IPTitle,IPReset:!1,isPanelOpen:!0,feedbackType:$.FeedBackType.domain})):""!==e?(i.OfferOrIpkitName=e.IPTitle,i.setState({IPObject:e,IPReset:!1,isPanelOpen:!0,feedbackType:$.FeedBackType.ipfeedback.toUpperCase()})):i.setState({isPanelOpen:!1})},i.ipFeedbackStatusUpdate=function(){var e=Object(g.a)(b.a.mark((function e(t,a,n){var s,r,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{n.toUpperCase()===i.successText.toUpperCase()?(i.ipFeedbackArchitect=a,s="The IP Feedback has been assigned to "+i.ipFeedbackArchitect[0]+" and "+i.ipFeedbackArchitect[1]+".",i.setState({ipFeedbackSurveyStatus:t,feedbackOnExistingIp:!0,allFeedback:!1,assignFeedback:!1,cancelFeedback:!1,manageTabActive:!1,showMessageBar:!0,messageBarType:te.a.success,messageBarMessage:s,tabSpinner:!0}),r=i.stroageObj.GetSessionStorage(i.activeSurveyDetails+i.siteName),o=JSON.parse(r),i.setProjectSiteIPSurveyDetails(o)):i.setState({feedbackOnExistingIp:!0,allFeedback:!1,assignFeedback:!1,cancelFeedback:!1,manageTabActive:!1,showMessageBar:!0,messageBarType:te.a.error,messageBarMessage:i.catchErrorMessage})}catch(c){m.AppInsightsTrackException(ft,"Exception occured at ipFeedbackStatusUpdate(). "+i.fileName,c)}case 1:case"end":return e.stop()}}),e)})));return function(t,a,i){return e.apply(this,arguments)}}(),i.state={siteUrl:"",hasTitle:!0,sourceName:"",feedbackOnExistingIp:!0,allFeedback:!1,assignFeedback:!1,cancelFeedback:!1,Sensitivity:0,showPivotTab:!1,ipFeedbackSurveyStatus:fe.invalid,isPanelOpen:!1,IPObject:"",IPReset:!1,isProjectManagementChannel:!1,feedbackType:"",manageTabActive:!1,messageBarType:te.a.success,messageBarMessage:"",showMessageBar:!1,tabSpinner:!1,activeSurveyDetail:new dt,assignedFeedbackId:0},i.isHeader=!0,i.tabClickEvent=i.tabClickEvent.bind(Object(k.a)(i)),i}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getProjectSiteIPSurveyDetails();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),m.AppInsightsTrackException(ft,"Exception occured at componentDidMount(). "+this.fileName,e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"getProjectSiteIPSurveyDetails",value:function(){var e=Object(g.a)(b.a.mark((function e(){var t=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.authService.getTokenWithLoginPopup("").then(function(){var e=Object(g.a)(b.a.mark((function e(a){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(a),e.next=3,t.webapi.GetCampusWebAPI1(h.Campus,"IPFeedback/GetManageIPFeedbackAssignmentDetails?projectSite=https://microsoft.sharepoint.com/teams/dev_stg_CampusModernProjects",a).then((function(e){e.length>0?(t.stroageObj.SetSessionStorage(t.activeSurveyDetails+t.siteName,JSON.stringify(e[0])),t.setProjectSiteIPSurveyDetails(e[0])):t.setState({ipFeedbackSurveyStatus:fe.invalid,tabSpinner:!1,assignedFeedbackId:0}),m.AppInsightsTrackEvent(ft,"Information","Feedback","API Success on getting getProjectSiteIPSurveyDetails()",JSON.stringify(e))})).catch((function(e){t.setState({ipFeedbackSurveyStatus:fe.invalid,tabSpinner:!1,assignedFeedbackId:0}),m.AppInsightsTrackException(ft,"Exception occured at getProjectSiteIPSurveyDetails()",e)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(a){m.AppInsightsTrackException(ft,"Exception occured at getProjectSiteIPSurveyDetails(). ",a)}case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("div",{className:"".concat(this.isHeader?y.a.HeaderClass1:y.a.HeaderClass2," ").concat(y.a.feedbackContainer)},n.a.createElement("div",{className:"".concat(y.a.tabHeader," tabheaderForAzureBasePage")},n.a.createElement("h1",null,"IP Feedback Form"),n.a.createElement("div",{className:y.a.customTabContainer},n.a.createElement("div",{className:y.a.tabsButtons,role:"tablist"},n.a.createElement("button",{className:this.state.feedbackOnExistingIp?y.a.tabActive:"",role:"tab","aria-selected":this.state.feedbackOnExistingIp,onClick:function(t){return e.tabClickEvent(t,$.ButtonName.existingIp)}},"Feedback on existing IP"),n.a.createElement("button",{className:this.state.allFeedback?y.a.tabActive:"",role:"tab","aria-selected":this.state.allFeedback,onClick:function(t){return e.tabClickEvent(t,$.ButtonName.allFeedback)}},"All Current Feedback"),this.state.isProjectManagementChannel&&n.a.createElement(Se,{InitialSensitivity:this.state.Sensitivity,setParentSensitivity:this.setSensitivity.bind(this),isActive:this.state.manageTabActive,resetActiveClass:this.resetActiveClass.bind(this),ipFeedbackSurveyStatus:this.state.ipFeedbackSurveyStatus,tabSpinner:this.state.tabSpinner})))),n.a.createElement("div",{className:"".concat(y.a.customTabContent," customTabContentForAzureBasePage")},this.state.showMessageBar&&n.a.createElement("div",{className:y.a.noFeedbackContainer},n.a.createElement(ae.a,{className:y.a.nofeedbacksmsg,messageBarType:this.state.messageBarType,onDismiss:this.onDismissMessageBar.bind(this),id:"IpFeedback-MessageBar",dismissButtonAriaLabel:"close"},this.state.messageBarMessage)),this.state.feedbackOnExistingIp&&n.a.createElement(ee,{siteUrl:this.state.siteUrl,sourceName:this.state.sourceName,setIPTitle:this._setIPTitle.bind(this),iPReset:this.state.IPReset,siteName:this.siteName}),this.state.allFeedback&&n.a.createElement(me,{url:this.state.siteUrl,sourceName:this.state.sourceName,siteName:this.siteName}),this.state.assignFeedback&&n.a.createElement(je,{url:this.state.siteUrl,surveyStatusCallback:this.ipFeedbackStatusUpdate.bind(this),siteName:this.siteName}),this.state.cancelFeedback&&n.a.createElement(Ve,{cancelEvent:this.cancelAssignment.bind(this),currentSurveryDetails:this.state.activeSurveyDetail,siteName:this.siteName}))),this.state.isPanelOpen&&n.a.createElement(pt,{OfferOrIpkitName:this.OfferOrIpkitName,SourceName:this.state.sourceName,IPObject:this.state.IPObject,IPReset:this.state.IPReset,SiteUrl:this.state.siteUrl,resetTree:this._resetTree.bind(this),feedbackType:this.state.feedbackType,assignedFeedbackId:this.state.assignedFeedbackId}))}},{key:"_resetTree",value:function(){var e=Object(g.a)(b.a.mark((function e(t,a){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.toUpperCase()!==this.successText.toUpperCase()){e.next=12;break}if(!(this.state.assignedFeedbackId>0&&this.state.activeSurveyDetail.ManageIPFeedbackAssignmentId>0)){e.next=9;break}return this.stroageObj.DeleteSessionStorage(this.activeSurveyDetails+this.siteName),e.next=6,this.resetProjectSiteIPSurveyDetails();case 6:this.setState({IPReset:!0,IPObject:"",isPanelOpen:!1,messageBarMessage:"The "+a+" Feedback Submitted Successfully.",messageBarType:te.a.success,showMessageBar:!0,manageTabActive:!1}),e.next=10;break;case 9:this.setState({IPReset:!0,IPObject:"",isPanelOpen:!1,messageBarMessage:"The "+a+" Feedback Submitted Successfully.",messageBarType:te.a.success,showMessageBar:!0,manageTabActive:!1});case 10:e.next=13;break;case 12:this.setState({IPReset:!0,IPObject:"",isPanelOpen:!1});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),m.AppInsightsTrackException(ft,"Exception occured at method _resetTree()",e.t0);case 18:case"end":return e.stop()}}),e,this,[[0,15]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"setSensitivity",value:function(e){try{switch(e){case 1:this.setState({feedbackOnExistingIp:!1,allFeedback:!1,assignFeedback:!0,cancelFeedback:!1,Sensitivity:e}),m.AppInsightsTrackEvent(ft,"Information","Assign IP Feedback","Assign IP Feedback button clicked","AssignIPFeedback");break;case 2:this.setState({feedbackOnExistingIp:!1,allFeedback:!1,assignFeedback:!1,cancelFeedback:!0,Sensitivity:e}),m.AppInsightsTrackEvent(ft,"Information","Cancel IP Feedback Assignment","Cancel IP Feedback Assignment clicked","CancelIPFeedbackAssignment")}}catch(t){m.AppInsightsTrackException(ft,"Exception occured at setSensitivity(). "+this.fileName,t)}}},{key:"tabClickEvent",value:function(e,t){try{var a;switch(t.toUpperCase()){case $.ButtonName.allFeedback.toUpperCase():this.setState({feedbackOnExistingIp:!1,allFeedback:!0,assignFeedback:!1,cancelFeedback:!1,manageTabActive:!1,Sensitivity:0});break;case $.ButtonName.existingIp.toUpperCase():default:this.setState({feedbackOnExistingIp:!0,allFeedback:!1,assignFeedback:!1,cancelFeedback:!1,manageTabActive:!1,Sensitivity:0})}e.preventDefault();var i=null!==(a=e.CurrentTarget.Id)&&void 0!==a?a:"";m.AppInsightsTrackEvent(ft,"Information","Sub-Tabs","IpFeedback Sub-tab Change Event.",i)}catch(n){m.AppInsightsTrackException(ft,"Exception occured at method tabClickEvent()",n)}}},{key:"GetIPkitListItems",value:function(e,t){var a=this;try{var i=new N,n="ipforumipkit"===t?"No IPKits found. Please check the team tab configuration.":"No Offers found. Please check the team tab configuration.",s="IPFeedback/GetIPKitandOffersItems?ipKitOfferSite="+e+"&sourceName="+t;i.GetCampusWebAPI(h.Campus,s).then((function(e){null===e||void 0===e||0===e.length||void 0!==e.Message?a.setState({showMessageBar:!0,messageBarMessage:n,messageBarType:te.a.error}):a.setState({showMessageBar:!1,messageBarMessage:n,messageBarType:te.a.error})}))}catch(r){m.AppInsightsTrackException(ft,"Exception occured at method GetIPkitListItems()",r)}}}]),a}(n.a.Component);new m("v-maytiw@microsoft.com",document.title),r.a.render(n.a.createElement(gt,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");o?(!function(e,t){fetch(e).then((function(a){var i=a.headers.get("content-type");404===a.status||null!=i&&-1===i.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):c(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):c(t,e)}))}}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},29:function(e,t,a){e.exports={cancelIpFeedback:"surveyUIComponent_cancelIpFeedback__UzTRd",bottomContent:"surveyUIComponent_bottomContent__1SoTl",btnRightAlign:"surveyUIComponent_btnRightAlign__MRZE1",pageCenterSpinner:"surveyUIComponent_pageCenterSpinner__1drtj",surveyBoxContainer:"surveyUIComponent_surveyBoxContainer__3JmYC",engagementStartupSection:"surveyUIComponent_engagementStartupSection__2Z9mV",surveyMsg:"surveyUIComponent_surveyMsg__1j_7Q",campusSearchLink:"surveyUIComponent_campusSearchLink__3bbU-",surveyRightPart:"surveyUIComponent_surveyRightPart__1jT_h"}},55:function(e,t,a){e.exports={fullPageCenterSpinner:"engagementIpSurvey_fullPageCenterSpinner__2hzvu",pageCenterSpinner:"engagementIpSurvey_pageCenterSpinner__7TWxy",errorMsg:"engagementIpSurvey_errorMsg__1lSb6",bottomleftAlign:"engagementIpSurvey_bottomleftAlign__PuGMM",bottomContent:"engagementIpSurvey_bottomContent__267hv",btnRightAlign:"engagementIpSurvey_btnRightAlign__U2Pie",engagementDialogFooterButton:"engagementIpSurvey_engagementDialogFooterButton__3ZJfv",engagementIpContr:"engagementIpSurvey_engagementIpContr__1KcDo",msgClose:"engagementIpSurvey_msgClose__3QQUC",subTitle:"engagementIpSurvey_subTitle__1vtEL",startUphome:"engagementIpSurvey_startUphome__IDbP8",closeOut:"engagementIpSurvey_closeOut__L5AY8",surveyFormContr:"engagementIpSurvey_surveyFormContr__Y5YxN",formFields:"engagementIpSurvey_formFields__3ug4x",nextCancelBtns:"engagementIpSurvey_nextCancelBtns__oBbMO",resourcesLink:"engagementIpSurvey_resourcesLink__Drlw2",resrcLinkwithOutBorder:"engagementIpSurvey_resrcLinkwithOutBorder__16Nm_",resrcLinkwithBorder:"engagementIpSurvey_resrcLinkwithBorder__IwDN8",resrcLinkwithChild:"engagementIpSurvey_resrcLinkwithChild__3KKmi",surveyBoxContainer:"engagementIpSurvey_surveyBoxContainer__2cpNL"}},6:function(e,t,a){e.exports={giveFeedbackPanelBtn:"ipfeedback_giveFeedbackPanelBtn__34nt9",pageCenterSpinner:"ipfeedback_pageCenterSpinner__N1UcZ",tabsbtnSpinner:"ipfeedback_tabsbtnSpinner__28Rh3",errorMandatory:"ipfeedback_errorMandatory__2eBqu",selectedField:"ipfeedback_selectedField__dtVAo","react-file-reader-button":"ipfeedback_react-file-reader-button__3fadj",feedbackFormContr:"ipfeedback_feedbackFormContr__1IFYH",customDropdown:"ipfeedback_customDropdown__gBNUR",msgClose:"ipfeedback_msgClose__19bcq",HeaderClass1:"ipfeedback_HeaderClass1__3qBLl",HeaderClass2:"ipfeedback_HeaderClass2__1pHP9",feedbackContainer:"ipfeedback_feedbackContainer__2z36E",feedbacklistContainer:"ipfeedback_feedbacklistContainer__Ghx90",feedbackListControl:"ipfeedback_feedbackListControl__2_lw5",tabHeader:"ipfeedback_tabHeader__-FIRL",feedbackpageTab:"ipfeedback_feedbackpageTab__1XK0N",existingTabcontainer:"ipfeedback_existingTabcontainer__AszTG",feedbackTabcontainer:"ipfeedback_feedbackTabcontainer__2SBsx",shareIdeaTabcontainer:"ipfeedback_shareIdeaTabcontainer__1ZCmu",customTabContent:"ipfeedback_customTabContent__7qfAK",tabsButtons:"ipfeedback_tabsButtons__3-2c1",tabOptionButton:"ipfeedback_tabOptionButton__2sOqb",tabActive:"ipfeedback_tabActive__2jNzm",disabledClass:"ipfeedback_disabledClass__3Xg-P",selectItemText:"ipfeedback_selectItemText__1s-CL",selectFilter:"ipfeedback_selectFilter__32-vq",searchBox:"ipfeedback_searchBox__3jwzv",leftContent:"ipfeedback_leftContent__WB2jM",leftInner:"ipfeedback_leftInner__AzPUl",rightContent:"ipfeedback_rightContent__1zQdL",rightContentSection:"ipfeedback_rightContentSection__Uj_SG",formFields:"ipfeedback_formFields__3e43K",bottomContent:"ipfeedback_bottomContent__3RcLE",attachmentContainer:"ipfeedback_attachmentContainer__1J_aE",attachmentInner:"ipfeedback_attachmentInner__2VtZA",attachmentList:"ipfeedback_attachmentList__310mO",browseUi:"ipfeedback_browseUi__18v9K",emailDescription:"ipfeedback_emailDescription__2BdHA",feebackSpinner:"ipfeedback_feebackSpinner__3ZdMG",feedbackDetailList:"ipfeedback_feedbackDetailList__7zYEd",feedbackListTd:"ipfeedback_feedbackListTd__2_UoU"}},92:function(e,t,a){}},[[139,1,2]]]);
//# sourceMappingURL=main.c62a97b0.chunk.js.map